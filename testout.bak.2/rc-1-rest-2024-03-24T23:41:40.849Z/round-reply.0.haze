
fun model, action ->
  case action
  | AddTodo => 
    let (buffer, todos) = model in 
    ((buffer, (buffer, false)::todos))
  | RemoveTodo(index) => 
    let (buffer, todos) = model in 
    ((buffer, List.remove_at(index, todos)))
  | ToggleTodo(index) => 
    let (buffer, todos) = model in 
    ((buffer, List.map_at(index, fun (text, done) -> (text, not done), todos)))
  | UpdateBuffer(new_buffer) => 
    let (_, todos) = model in 
    ((new_buffer, todos))
  end