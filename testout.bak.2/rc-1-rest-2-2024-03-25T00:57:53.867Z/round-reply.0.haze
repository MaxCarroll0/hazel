fun m, a ->
    case a
    | AddBooking(user, day, time) =>
        let booking_id = snd(m) + 1 in 
        let new_booking = {day; time; user; booking_id} in
        let new_state = (new_booking::snd(m), booking_id) in 
        new_state
    | CancelBooking(user, id) => 
        let new_stay = List.filter(fun x -> x.user != user && x.booking_id != id) (snd(m)) in 
        (fst(m), new_stay, snd(m))
    | ClearBookings => (fst(m), [], snd(m)) end