fun m, action ->
  case action
  | Toggle(index) => {m with todos = toggle(index, m.todos)}
  | Remove(index) => {m with todos = remove(index, m.todos)}
  | Add(text) => {m with todos = add(m)}
  | Filter(value) => {m with filter = value}
  | Change(text) => {m with input = text}
  | ClearCompleted => {m with todos = List.filter((fun todo -> not todo.done), m.todos)}
  end