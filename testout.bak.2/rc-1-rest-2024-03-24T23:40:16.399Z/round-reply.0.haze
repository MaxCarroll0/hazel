
fun model, action ->
  case action
  | AddTodo => (model.buffer, (model.buffer, false)::model.todos)
  | RemoveTodo(id) =>
    let filtered_todos = List.filteri(fun idx, _ -> idx != id, model.todos) in
    (model.buffer, filtered_todos)
  | ToggleTodo(id) =>
    let toggled_todos = List.mapi(fun idx, (content, done) -> if idx == id then (content, not done) else (content, done), model.todos) in
    (model.buffer, toggled_todos)
  | UpdateBuffer(buffer) => (buffer, model.todos)
  end