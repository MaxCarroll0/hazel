fun m, a ->
  case a
  | AddTodo =>
    let (buffer, todos) = m in
    ("", ((buffer, false) :: todos))
  | RemoveTodo(n) =>
    let (_, todos) = m in
    ("", List.remove_at(n, todos))
  | ToggleTodo(n) =>
    let (_, todos) = m in
    ("", List.mapi(fun i, (text, done) -> if i == n then (text, not(done)) else (text, done), todos))
  | UpdateBuffer(new_buffer) =>
    let (_, todos) = m in
    (new_buffer, todos)
  end