fun (model, action) ->
  case action
  | AddSong(song) => { model with songs = song::get_songs(model) }
  | RemoveSong(song_id) => { model with songs = List.filter((fun s -> Id.neq(s.id, song_id)), get_songs(model)) }
  | TogglePlay => { model with state = if get_state(model) == Playing then Paused else Playing }
  | UpdateName(new_name) => { model with name = new_name }
  end