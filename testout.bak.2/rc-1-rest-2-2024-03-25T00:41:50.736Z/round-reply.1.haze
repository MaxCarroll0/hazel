fun (model, action) ->
  case action
  | Play => { model with is_playing = True }
  | Pause => { model with is_playing = False }
  | Next => { model with current_song = model.current_song + 1 }
  | Prev => { model with current_song = model.current_song - 1 }
  | SetVolume(volume) => { model with volume = volume }
  | AddTrack(track) => { model with tracks = List.append(track, model.tracks) }
  | RemoveTrack(track) => { model with tracks = List.filter(fun t -> t != track, model.tracks) }
  end