
fun model, action ->
case action
| PlaySong(id) => (model.0, Playing(id))
| PauseCurrentSong => 
  case model.1
  | Playing(id) => (model.0, PausedOn(id))
  | _ => model
  end
| RemoveSong(id) => (List.filter(fun song_id -> song_id != id, model.0), model.1)
| AddSong(id) => (id::model.0, model.1)
end