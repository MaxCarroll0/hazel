let update: (Model, Action) -> Model =
  fun (model, action) -> 
  case action
    | Increment => {model with counter = model.counter + 1}
    | Decrement => if model.counter > 0 then {model with counter = model.counter - 1} else model
  end
in
