fun (playlist, action) ->
    case action
    | AddTrack(track) => track::playlist
    | RemoveTrack(track) => List.filter(fun t -> t <> track, playlist)
    | ClearPlaylist => [] 
    end