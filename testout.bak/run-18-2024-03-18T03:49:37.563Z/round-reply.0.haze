fun (playlist, action) ->
  case action 
    | PlaySong(id)       => (playlist, Playing(id))
    | PauseCurrentSong   => (playlist, PausedOn(0))     # Assuming 0 is an invalid ID
    | RemoveSong(id)     => (List.remove(id, playlist), NoSongSelected)
    | AddSong(id)        => ((id::playlist), NoSongSelected)
    end
