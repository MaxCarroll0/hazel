
fun playlist, action ->
  let (songList, playlistState) = playlist in
  case action
  | PlaySong(newId) => (songList, Playing(newId))
  | PauseCurrentSong => 
    case playlistState
    | Playing(songId) => (songList, PausedOn(songId))
    | _ => playlist
    end
  | RemoveSong(songId) => 
    let newSongList = List.filter(fun x -> x != songId, songList) in
    (newSongList, playlistState)
  | AddSong(songId) => (songId::songList, playlistState)
  end