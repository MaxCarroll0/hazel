fun playlist, action ->
  case action of
    | PlaySong(songId) => (fst(playlist), Playing(songId))
    | PauseCurrentSong => (fst(playlist), case snd(playlist) of 
                                           | Playing(songId) => PausedOn(songId) 
                                           | _ => snd(playlist) end)
    | RemoveSong(songId) => (List.filter(fun id -> id != songId)(fst(playlist)), snd(playlist))
    | AddSong(songId) => (songId::fst(playlist), snd(playlist)) end