fun model, action ->
    case action
      | PlaySong(id) => (get_songs(model), Playing(id))
      | PauseCurrentSong => (get_songs(model), case get_state(model) of 
                                                         | Playing(id) => PausedOn(id)
                                                         | _ => NoSongSelected 
                                                         end)
      | RemoveSong(id) => (List.filter((fun songId -> songId != id), get_songs(model)), get_state(model))
      | AddSong(id) => (List.append(get_songs(model), [id]), get_state(model))
    end