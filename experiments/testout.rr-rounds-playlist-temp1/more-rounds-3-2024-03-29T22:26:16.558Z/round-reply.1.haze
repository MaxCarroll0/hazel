fun (m , action) ->
  case action
  | PlaySong(id) => (get_songs(m), Playing(id))
  | PauseCurrentSong => (get_songs(m), case get_state(m) of | Playing(id) => PausedOn(id)  | _ => get_state(m) end)
  | RemoveSong(id) => (List.filter((fun songId -> songId != id), get_songs(m)), get_state(m))
  | AddSong(id) => (List.append(get_songs(m), [id]), get_state(m)) 
  end