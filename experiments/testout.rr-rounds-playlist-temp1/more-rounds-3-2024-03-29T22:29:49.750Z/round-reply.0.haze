
fun (playlist, action) ->
let ((songs, state), action) = (playlist, action) in
case action
| PlaySong(id) => (songs, Playing(id))
| PauseCurrentSong =>
  case state
  | Playing(id) => (songs, PausedOn(id))
  | _ => playlist
  end
| RemoveSong(id) => (List.filter((fun song_id -> song_id != id), songs), state)
| AddSong(id) => (songs ++ [id], state)
end