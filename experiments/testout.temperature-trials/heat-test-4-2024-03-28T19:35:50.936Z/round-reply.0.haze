
fun (playlist, action) ->
  case action
    | PlaySong(track_id) => (get_songs(playlist), Playing(track_id))
    | PauseCurrentSong => (get_songs(playlist), case get_state(playlist) of
                                                | Playing(track_id) => PausedOn(track_id)
                                                | _ => NoSongSelected
                                            end)
    | RemoveSong(track_id) => (List.filter(fun t -> t != track_id, get_songs(playlist)), get_state(playlist))
    | AddSong(track_id) => (track_id::get_songs(playlist), get_state(playlist)) 
   end