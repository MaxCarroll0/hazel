fun model, action ->
    case action
    | PlaySong(id) => (get_songs(model), Playing(id))
    | PauseCurrentSong => 
        case get_state(model) 
        | Playing(song_id) => (get_songs(model), PausedOn(song_id))
        | PausedOn(song_id) => (get_songs(model), PausedOn(song_id))
        | NoSongSelected => model
        end
    | RemoveSong(id) => (List.filter((fun song_id -> song_id != id), get_songs(model)), get_state(model))
    | AddSong(id) => (id::get_songs(model), get_state(model))
    end