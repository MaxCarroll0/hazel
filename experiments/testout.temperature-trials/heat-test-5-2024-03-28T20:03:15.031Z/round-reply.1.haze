fun model, action ->
    case action
    | AddPlaylist(name) => List.append(model, [PlayList(name, [])])
    | RemovePlaylist(index) => List.remove(index, model)
    | AddSong(index, song) =>
        let playlist = List.nth(model, index) in
        let songs = second(playlist) in
        let updatedSongs = List.append(songs, [song]) in
        let updatedPlaylist = PlayList(first(playlist), updatedSongs) in
        List.replace(model, index, updatedPlaylist)
    | RemoveSong(playlistIndex, songIndex) =>
        let playlist = List.nth(model, playlistIndex) in
        let songs = second(playlist) in
        let updatedSongs = List.remove(songIndex, songs) in
        let updatedPlaylist = PlayList(first(playlist), updatedSongs) in
        List.replace(model, playlistIndex, updatedPlaylist)
    end