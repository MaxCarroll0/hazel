# Update Playlist app model based on an action #

let update: (PlayList, PlayListAction) -> PlayList =
  fun model, action ->
    case action
    | AddPlaylist(name) => model ++ [(name, [])]
    | RemovePlaylist(index) => List.remove_index(index, model)
    | AddSong(index, song) =>
        let (name, songs) = List.get_at(index, model) in
        let updatedSongs = songs ++ [song] in
        let updatedPlaylist = (name, updatedSongs) in
        List.update_at(index, updatedPlaylist, model)
    | RemoveSong(playlistIndex, songIndex) =>
        let (name, songs) = List.get_at(playlistIndex, model) in
        let updatedSongs = List.remove_index(songIndex, songs) in
        let updatedPlaylist = (name, updatedSongs) in
        List.update_at(playlistIndex, updatedPlaylist, model)
    end
in