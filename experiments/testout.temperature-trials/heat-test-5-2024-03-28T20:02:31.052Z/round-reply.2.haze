fun model, action ->
    case action
      | Pause => { model with isPlaying = false }
      | Play => { model with isPlaying = true }
      | ToggleRepeat => { model with repeat = !model.repeat }
      | ToggleShuffle => { model with shuffle = !model.shuffle }
      | NextTrack =>
        if model.currentTrack + 1 < List.length(model.tracks) then
          { model with currentTrack = model.currentTrack + 1 }
        else
          model
      | PreviousTrack =>
        if model.currentTrack > 0 then
          { model with currentTrack = model.currentTrack - 1 }
        else
          model
    end