
fun model, action ->
  case action
  | AddSong(song) => model.songs::song
  | DeleteSong(song) => List.filter(fun s -> s != song, model.songs)
  | Play => { model with is_playing = true }
  | Pause => { model with is_playing = false }
  | Stop => { model with is_playing = false; current_song = None }
  | Next => let next_song = List.nth(model.songs, model.current_song + 1) in
            { model with current_song = next_song }
  | Prev => let prev_song = List.nth(model.songs, model.current_song - 1) in
            { model with current_song = prev_song }
  end