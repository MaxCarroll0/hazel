fun (password, criteria, strength), action ->
    case action
      | UpdatePassword(new_password) => (new_password, criteria, strength)
      | ClearCriteria => ("", [], Weak)
      | AddCriterion(criterion) => (password, criterion::criteria, strength)
      | RemoveCriterion(criterion) => (password, List.filter(criteria, fun c -> !(c == criterion)), strength)
    end