
fun model, action ->
  case action
  | AddBooking(user, day, tod) => let (form, bookings, id) = model in
      (form, (day, tod, user, id + 1)::bookings, id + 1)
  | CancelBooking(user, id) => let (form, bookings, id) = model in
      let bookings = List.filter((fun (_, _, booking_user, booking_id) ->
        not (booking_user == user && booking_id == id)), bookings) in
      (form, bookings, id)
  | ClearBookings => let (form, bookings, id) = model in
      (initFormState, [], 0)
  end