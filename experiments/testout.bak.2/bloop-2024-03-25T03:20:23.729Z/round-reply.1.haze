fun (model, action) ->
    case action
    | AddBooking(user, day, time) =>
        let new_id = string_length(user) + mod(model.3, 10) in
        ((day, time, new_id), ((day, time), user, new_id)::model.2, new_id)
    | CancelBooking(user, id) =>
        (model.1, rm_booking(user, id, model.2), model.3)
    | ClearBookings =>
        (initFormState, [], 0)
    end