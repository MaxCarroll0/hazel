fun model, action ->
  case action
  | Toggle(i) => { model with todos = toggle(i, model.todos) }
  | Remove(i) => { model with todos = remove(i, model.todos) }
  | Add() => add(model)
  | Update(new_input) => { model with input = string_trim(string_sub(new_input, 0, String.length(new_input))) }
  end