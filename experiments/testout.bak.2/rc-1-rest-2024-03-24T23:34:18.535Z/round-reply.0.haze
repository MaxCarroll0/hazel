fun model, action ->
    let (buffer, todos) = model in
      case action
      | AddTodo =>
          let trimmed_buffer = string_trim(buffer) in
            if trimmed_buffer != "" then
              ( "", add(model) )
            else
              model
      | RemoveTodo(idx) =>
          ( buffer, remove(idx, todos) )
      | ToggleTodo(idx) =>
          ( buffer, toggle(idx, todos) )
      | UpdateBuffer(str) =>
          ( str, todos )
      end