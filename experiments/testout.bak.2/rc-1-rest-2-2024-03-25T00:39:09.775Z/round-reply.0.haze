fun (playlist, action) ->
case action
    | PlaySong(songID) => (playlist, Playing(songID))
    | PauseCurrentSong =>
        case playlist of
            | (_, Playing(songID)) => (playlist, PausedOn(songID))
            | not_playing -> not_playing  # if not playing, do nothing
        end
    | RemoveSong(songID) => (List.remove(playlist, songID), playlist)
    | AddSong(songID) => (List.append(playlist, songID), playlist)
    end
end