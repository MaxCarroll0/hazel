fun (form_data, bookings, next_id), action ->
  case action
  | AddBooking(user, weekday, time) => let new_booking = ((weekday, time), user, next_id + 1) in (form_data, new_booking :: bookings, next_id + 1)
  | CancelBooking(user, id) => (form_data, rm_booking(user, id, bookings), next_id)
  | ClearBookings => (initFormState, [], 0)
  end