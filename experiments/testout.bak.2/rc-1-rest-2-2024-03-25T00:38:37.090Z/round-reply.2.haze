fun (playlist, action) ->
  let (songs, state) = playlist in
  case action
  | PlaySong(id) =>  (songs, Playing(id))
  | PauseCurrentSong => 
      case state
      | Playing(id) =>  (songs, PausedOn(id))
      | x => (songs, x)
      end
  | RemoveSong(id) => ((filter(fun x -> x != id, songs), state))
  | AddSong(id) => ((id::songs, state))
  end