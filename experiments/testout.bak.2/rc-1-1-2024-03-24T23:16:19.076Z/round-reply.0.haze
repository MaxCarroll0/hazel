fun model, action ->
      case action
        | SelectEmoji(new_emoji) => (fst3(model), new_emoji, trd3(model))
        | StampEmoji((row, col)) => (update_grid(snd3(model), (row, col), fst3(model)), snd3(model), trd3(model))
        | ClearCell((row, col)) => (update_grid("", (row, col), fst3(model)), snd3(model), trd3(model))
        | ClearGrid => (initialize_grid(), snd3(model), trd3(model))
        | FillRow(row) => (fill_row(row, snd3(model), fst3(model)), snd3(model), trd3(model))
      end