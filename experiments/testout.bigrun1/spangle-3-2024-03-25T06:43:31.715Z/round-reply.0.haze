
fun model, action ->
  case action 
  | SetColor c => { model with color = c }
  | SetStrokeWidth w => { model with stroke_width = w }
  | SetStrokeAlpha a => { model with stroke_alpha = a }
  | SetStrokeType t => { model with stroke_type = t }
  | AppendStroke s => { model with strokes = model.strokes @ [s] }
  | Clear => { color = Black; stroke_width = 1; stroke_alpha = 1.0; stroke_type = Line; strokes = [] }
  end