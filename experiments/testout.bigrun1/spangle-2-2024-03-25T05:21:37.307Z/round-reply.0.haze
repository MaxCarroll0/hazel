fun (model, action) ->
  let (buffer, todos) = model in
  case action
  | AddTodo =>
    let trimmed = string_trim(buffer) in
    if trimmed != "" then 
      (string_concat("", []), add((string_trim(buffer), todos)))
    else model
  | UpdateBuffer(new_buffer) => (new_buffer, todos)
  | ToggleTodo(idx) => (buffer, toggle((idx, todos)))
  | RemoveTodo(idx) => (buffer, remove((idx, todos)))
  end