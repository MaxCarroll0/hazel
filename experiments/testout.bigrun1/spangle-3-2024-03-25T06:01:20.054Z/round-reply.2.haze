fun (model, action) ->
    let (form, bookings, id_counter) = model in
    let next_id = id_counter + 1 in
    case action
    | AddBooking(user, day, time) => ((day, time, next_id), user)::bookings, next_id
    | CancelBooking(user, id) => 
        let new_bookings = rm_booking(user, id, bookings) in
        (form, new_bookings, id_counter)
    | ClearBookings => (form, [], id_counter)
    end