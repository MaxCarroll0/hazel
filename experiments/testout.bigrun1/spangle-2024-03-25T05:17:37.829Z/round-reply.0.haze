fun m, a ->
case a
| AddTodo(t) => let (b, todos) = m in (b, todos@[(t, false)])
| RemoveTodo(i) => let (b, todos) = m in (b, List.remove(i, todos))
| ToggleTodo(i) => let (b, todos) = m in (b, List.update(i, fun (t, done) -> (t, !done), todos))
| UpdateBuffer(text) => let (_, todos) = m in (text, todos)
end