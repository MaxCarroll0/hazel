fun (model, action) ->
  case action
  | EnterPassword(new_password) => 
    { 
      model with
      password = new_password,
      passwordStrength = calculateStrength(new_password, model.criteria)
    }
  | ToggleCriteria(criterion) =>
    let new_criteria = List.map (fun c ->
      if (c == criterion) then not(c) else c) model.criteria in
    {
      model with 
      criteria = new_criteria, 
      passwordStrength = calculateStrength(model.password, new_criteria)
    } 
  end