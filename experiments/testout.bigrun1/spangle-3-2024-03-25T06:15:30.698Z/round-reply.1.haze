fun model, action ->
  case action
  | BookRoom(room_id) => model with { rooms = update_rooms(model.rooms, room_id, true) }
  | CancelRoom(room_id) => model with { rooms = update_rooms(model.rooms, room_id, false) }
  | CheckIn(guest_id) => model with { guests = update_guests(model.guests, guest_id, true) }
  | CheckOut(guest_id) => model with { guests = update_guests(model.guests, guest_id, false) }
  end