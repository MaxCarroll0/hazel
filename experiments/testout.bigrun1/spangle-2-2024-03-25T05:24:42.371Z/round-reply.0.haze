fun model, action ->
  let buffer, todos = model in
  case action
  | AddTodo =>
      let new_todo = (buffer, false) in
      (buffer, new_todo::todos)
  | RemoveTodo(index) =>
      let new_todos = List.remove(index, todos) in
      (buffer, new_todos)
  | ToggleTodo(index) =>
      let new_todos = List.update(index, fun todo -> let text, done = todo in (text, !done), todos) in
      (buffer, new_todos)
  | UpdateBuffer(text) =>
      (text, todos)
  end