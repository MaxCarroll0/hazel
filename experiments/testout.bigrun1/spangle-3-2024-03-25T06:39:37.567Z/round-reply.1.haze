fun model, action ->
  case action
  | Paint(emoji) => {model with tool = Some(emoji)}
  | Clear => {model with canvas = blank_canvas(); tool = None}
  | Undo => {model with canvas = do_undo(model.undo_stack)}
  end