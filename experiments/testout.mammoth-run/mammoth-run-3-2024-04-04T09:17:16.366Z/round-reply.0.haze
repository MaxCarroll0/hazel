
fun model, action ->
  case action
  | SelectEmoji(emoji) => (fst(model), emoji, trd(model))
  | StampEmoji((row, col)) => (Util.stamp_emoji_on_grid(fst(model), row, col, snd(model)), snd(model), trd(model))
  | ClearCell((row, col)) => (Util.clear_cell_in_grid(fst(model), row, col), snd(model), trd(model))
  | ClearGrid => (Util.clear_grid(fst(model)), snd(model), trd(model))
  | FillRow(row) => (Util.fill_row_in_grid(fst(model), row, snd(model)), snd(model), trd(model))
  end