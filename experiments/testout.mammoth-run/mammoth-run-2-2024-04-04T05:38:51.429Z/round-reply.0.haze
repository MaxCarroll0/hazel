fun model, action ->
  case action
  | AddSong(id) => PlayList(get_songs(model) @ [id], get_state(model))
  | RemoveSong(id) => PlayList(List.filter(fun song -> song != id, get_songs(model)), get_state(model))
  | Play => PlayList(get_songs(model), Playing)
  | Pause => PlayList(get_songs(model), Paused)
  | Stop => PlayList(get_songs(model), Stopped)
  end