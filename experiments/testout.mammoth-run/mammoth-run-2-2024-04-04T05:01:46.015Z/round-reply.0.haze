fun (buffer, todos), action ->
  case action
  | AddTodo =>
      if buffer $== "" then (buffer, todos)
      else ("", (buffer, false)::todos)
  | RemoveTodo(idx) =>
      (buffer, List.remove(idx, todos))
  | ToggleTodo(idx) =>
      (buffer,
       List.mapi(fun i, (desc, status) ->
                  if i == idx then (desc, !status)
                  else (desc, status),
                todos))
  | UpdateBuffer(str) =>
      (str, todos)
  end