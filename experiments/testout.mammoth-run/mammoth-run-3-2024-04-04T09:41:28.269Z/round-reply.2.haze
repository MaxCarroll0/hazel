fun (model, action) ->
  case action
  | UpdatePassword(new_password) => 
      let strength = calculateStrength(new_password, model.passwordCriteria) in
      {model with password = new_password; passwordStrength = strength}
  | AddCriteria(new_criteria) => 
      let updated_criteria = new_criteria::model.passwordCriteria in
      let strength = calculateStrength(model.password, updated_criteria) in
      {model with passwordCriteria = updated_criteria; passwordStrength = strength}
  end