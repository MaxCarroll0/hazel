
fun model, action -> 
  case action
  | AddTodo => (model.1, (model.1, false)::model.2)
  | RemoveTodo(idx) => (model.1, List.remove(idx, model.2))
  | ToggleTodo(idx) => (model.1, List.update(idx, fun (_, b) -> (model.1, !b), model.2))
  | UpdateBuffer(new_buffer) => (new_buffer, model.2)
  end