
fun (model, action) ->
  case action
    | AddTodo => 
      let (buffer, todos) = model in
      (buffer, Todo(buffer)::todos)
    | RemoveTodo(index) => 
      let (buffer, todos) = model in
      (buffer, List.remove(index, todos))
    | ToggleTodo(index) => 
      let (buffer, todos) = model in
      (buffer, List.update(index, Todo.toggle, todos))
    | UpdateBuffer(new_buffer) => 
      (new_buffer, snd(model))
  end