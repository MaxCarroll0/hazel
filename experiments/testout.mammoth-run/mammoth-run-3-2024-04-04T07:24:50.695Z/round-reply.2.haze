fun (buffer, todos), action ->
    case action
    | AddTodo => if buffer /= "" then (buffer, (buffer, false)::todos) else (buffer, todos)
    | RemoveTodo(i) => (buffer, List.removeAt(i, todos))
    | ToggleTodo(i) => (buffer, List.updateAt(i, fun (d, s) -> (d, not s), todos))
    | UpdateBuffer(s) => (s, todos)
    end