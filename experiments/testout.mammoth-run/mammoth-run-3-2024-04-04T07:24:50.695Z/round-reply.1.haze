fun (buffer, todos), action ->
    case action
    | AddTodo => if buffer /= "" then (buffer, (buffer, false)::todos) else (buffer, todos)
    | RemoveTodo(i) => (buffer, List.remove(i)(todos))
    | ToggleTodo(i) => (buffer, List.update(i)(fun (d, s) -> (d, not s))(todos))
    | UpdateBuffer(s) => (s, todos)
    end