fun (grid, currentEmoji, emojiList), action ->
  case action
  | SelectEmoji(newEmoji) => (grid, newEmoji, emojiList)
  | StampEmoji((row, col)) => (List.map2(fun r e -> if r == row then List.map2(fun c e -> if c == col then currentEmoji else e) e else e) grid, currentEmoji, emojiList)
  | ClearCell((row, col)) => (List.map2(fun r e -> if r == row then List.map2(fun c e -> if c == col then "" else e) e else e) grid, currentEmoji, emojiList)
  | ClearGrid => (List.map(fun e -> List.map(fun _ -> "") e) grid, currentEmoji, emojiList)
  | FillRow(targetRow) => (List.map2(fun r e -> if r == targetRow then List.map(fun _ -> currentEmoji) e else e) grid, currentEmoji, emojiList)