fun (model, action) ->
    case action
    | AddTodo => (model[0], model[1]++[model[0]])
    | RemoveTodo(i) => (model[0], List.remove(i, model[1]))
    | ToggleTodo(i) => let (d, s) = List.nth(i, model[1]) in (model[0], List.update(i, (d, !s), model[1]))
    | UpdateBuffer(str) => (str, model[1])
    end