fun (model, action) ->
    case action
    | Play(song) => { model with now_playing = Some(song) }
    | Pause => { model with now_playing = None }
    | Add(song) => { model with songs = song :: model.songs }
    | Remove(song) => { model with songs = List.filter((fun s -> s != song), model.songs) }
    end