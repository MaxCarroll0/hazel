fun (model, action) ->
  case action 
  | AddBooking((user, weekday, time)) => let (booking_form_data, bookings, id) = model in
                                         let new_booking = ((weekday, time), user, id + 1) in
                                         ((weekday, time), user), new_booking::bookings, id + 1
  | CancelBooking((user, id)) => let (booking_form_data, bookings, booking_id) = model in
                                  (booking_form_data, List.filter(fun ((_, _), u, i) -> u != user \/ i != id, bookings), booking_id)
  | ClearBookings => let (booking_form_data, _, booking_id) = model in
                      (booking_form_data, [], booking_id)
  end