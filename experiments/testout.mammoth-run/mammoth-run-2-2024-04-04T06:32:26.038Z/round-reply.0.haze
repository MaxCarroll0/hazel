
fun model, action ->
  let (grid, current_emoji, emoji_palette) = model in
  case action
  | SelectEmoji(emoji) => (grid, emoji, emoji_palette)
  | StampEmoji((row, col)) => (List.update(row, List.update(col, current_emoji, List.nth(row, grid)), grid), current_emoji, emoji_palette)
  | ClearCell((row, col)) => (List.update(row, List.update(col, "", List.nth(row, grid)), grid), current_emoji, emoji_palette)
  | ClearGrid => ([], current_emoji, emoji_palette)
  | FillRow(row) => (List.update(row, List.repeat(List.length(List.nth(row, grid)), current_emoji), grid), current_emoji, emoji_palette)
  end