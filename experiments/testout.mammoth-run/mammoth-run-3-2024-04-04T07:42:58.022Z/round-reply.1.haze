fun m, a ->
  case a
  | AddTodo => (fst(m), (fst(m), false)::snd(m))
  | RemoveTodo(i) => (fst(m), List.remove(i, snd(m)))
  | ToggleTodo(i) => 
      let todo = List.nth(snd(m), i) in
      let updated_todo = (fst(todo), !snd(todo)) in
      (fst(m), List.update(i, updated_todo, snd(m)))
  | UpdateBuffer(s) => (s, snd(m))
  end