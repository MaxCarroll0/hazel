
fun (playlist, action) ->
  case action
  | PlaySong(id) => (playlist, Playing(id))
  | PauseCurrentSong => 
    case playlist
    | (_, Playing(id)) => (playlist, PausedOn(id))
    | _ => playlist
  | RemoveSong(id) => 
    let (songList, state) = playlist in
    let newSongList = List.filter(fun songId -> songId != id, songList) in
    (newSongList, state)
  | AddSong(id) => 
    let (songList, state) = playlist in
    let newSongList = id::songList in
    (newSongList, state)
  end