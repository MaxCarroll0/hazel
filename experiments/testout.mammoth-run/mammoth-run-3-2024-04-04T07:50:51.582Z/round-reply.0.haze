fun (playlist, action) ->
  case action
  | PlaySong(id) => (id::fst(playlist), Playing(id))
  | PauseCurrentSong => (fst(playlist), PausedOn(hd(fst(playlist))))
  | RemoveSong(id) => (List.remove(id, fst(playlist)), snd(playlist))
  | AddSong(id) => (id::fst(playlist), snd(playlist))
  end