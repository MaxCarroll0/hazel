fun model, action ->
  case action
  | SelectEmoji(emoji) => (model.1, emoji, model.3)
  | StampEmoji((row, col)) => (List.update(row, List.update(col, model.2, model.1[row]), model.1), model.2, model.3)
  | ClearCell((row, col)) => (List.update(row, List.update(col, "", model.1[row]), model.1), model.2, model.3)
  | ClearGrid => (List.map(fun _ -> List.map(fun _ -> "", model.1), model.1), model.2, model.3)
  | FillRow(row) => (List.update(row, List.map(fun _ -> model.2, model.1[row]), model.1), model.2, model.3)
  end