fun model, action ->
  case action
    | AddBooking(user, time, id) => 
      if bookingExists(model, (time, user, id))
      then model
      else addBooking(model, (time, user, id))
    | DeleteBooking(id) => deleteBooking(model, id)
    | UpdateForm(time, user) => updateForm(model, (time, user))
  end