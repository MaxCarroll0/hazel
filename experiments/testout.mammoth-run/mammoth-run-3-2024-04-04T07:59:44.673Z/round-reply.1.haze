fun model, action ->
  case action
  | AddSong(id) => { model with songs = id :: get_songs(model) }
  | RemoveSong(id) => { model with songs = List.filter(fun song_id -> song_id != id, get_songs(model)) }
  | TogglePlay => { model with state = match get_state(model) with
                                    | Playing -> Paused
                                    | Paused -> Playing
                                    | _ -> get_state(model) end }
  | Stop => { model with state = Stopped }
  end