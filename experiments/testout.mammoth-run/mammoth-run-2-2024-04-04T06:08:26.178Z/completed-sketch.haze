# Update the Room Booking app model based on an action #

let update: (Model, Action) -> Model =
  fun model, action ->
  case action
  | Book(room_id) => 
    {
      model with
      rooms = Map.update model.rooms room_id (fun room -> { room with is_booked = true })
    }
  | Cancel(room_id) => 
    {
      model with
      rooms = Map.update model.rooms room_id (fun room -> { room with is_booked = false })
    }
  end
in
