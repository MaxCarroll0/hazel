fun (model, action) ->
  case action
  | SelectEmoji(emoji) => (model[0], emoji, model[2])
  | StampEmoji(row, col) => let updated_grid = updateGrid(model[0], row, col, model[1]) in (updated_grid, model[1], model[2])
  | FillRow(row) => let updated_grid = List.map(fun r -> if r == row then List.map(fun _ -> model[1]) (List.nth(model[0], r)) else List.nth(model[0], r), List.range(0, List.length(model[0]) - 1)) in (updated_grid, model[1], model[2])
  end