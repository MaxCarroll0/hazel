# Update the EmojiPaint app model based on an action #

let update: (Model, Action) -> Model =
  fun (model, action) ->
    case action
    | SelectEmoji(emoji) => (emoji, model[1])
    | StampEmoji(row, col) => let new_grid = updateGrid(model[0], row, col, model[1]) in (model[1], new_grid)
    | FillRow(row) => let new_grid = List.map(model[0], fun r -> if r == row then List.map(r, fun _ -> model[1]) else r) in (model[1], new_grid)
    end
in
