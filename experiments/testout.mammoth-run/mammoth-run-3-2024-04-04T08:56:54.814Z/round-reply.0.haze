fun model, action ->
  case action 
  | AddTodo => (fst(model), Todo("New Todo", false) :: snd(model))
  | RemoveTodo(i) => (fst(model), List.remove_nth(i, snd(model)))
  | ToggleTodo(i) => (fst(model), List.map(fun (idx, (desc, complete)) -> if idx == i then (desc, !complete) else (desc, complete), List.mapi(fun idx, todo -> (idx, todo), snd(model))))
  | UpdateBuffer(s) => (s, snd(model))
  end