fun model, action ->
    case action
      | AddBooking(user, weekday, time) => if !bookingExists(model, (time, user, nextID(model))) then model else addBooking(model, (time, user, nextID(model)))
      | RemoveBooking(id) => removeBooking(model, id)
      | UpdateBuffer(time, user) => (updateBuffer(model, (time, user)), getBookings(model), nextID(model))
    end