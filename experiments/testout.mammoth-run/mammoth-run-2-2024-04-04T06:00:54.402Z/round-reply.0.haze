fun model, action ->
  case action
  | AddBooking(user, weekday, timeOfDay) =>
    let booking = (weekday, timeOfDay), user, model.2 + 1 in
    (model.0, booking :: model.1, model.2 + 1)
  | CancelBooking(user, id) =>
    let bookings = List.filter(fun b -> b.2 != id, model.1) in
    (model.0, bookings, model.2)
  | ClearBookings =>
    (model.0, [], model.2)
  end