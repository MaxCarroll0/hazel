fun (model, action) ->
  case action
    | AddTodo => (model[0], model[1]::model[2])
    | RemoveTodo(i) => (model[0], List.remove(i, model[2]))
    | ToggleTodo(i) => (model[0], List.map((fun (j, todo) -> if i == j then (todo[0], !todo[1]) else todo), List.mapi(fun i, todo -> (i, todo), model[2])))
    | UpdateBuffer(s) => (s, model[2])
  end