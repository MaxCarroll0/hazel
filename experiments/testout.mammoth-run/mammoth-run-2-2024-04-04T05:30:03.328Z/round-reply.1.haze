fun model, action ->
  case action
  | Add(id) => PlayList(get_state(model), id :: get_songs(model))
  | Remove(id) => PlayList(get_state(model), List.remove(id, get_songs(model)))
  | TogglePlay => 
    let new_state = match get_state(model) with
      | Playing => Paused
      | Paused => Playing
    in PlayList(new_state, get_songs(model))
  | SetPlayListState(state) => PlayList(state, get_songs(model))
  end