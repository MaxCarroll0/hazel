fun model, action ->
  case action
  | AddSong(song) => model.songs = song::model.songs
  | RemoveSong(songId) => model.songs = List.filter((fun song -> song.id != songId), model.songs)
  | Pause => model.isPlaying = false
  | Play => model.isPlaying = true
  | Stop => model.isPlaying = false; model.currentSong = None
  | Next => model.currentSong = getNextSong(model)
  | Prev => model.currentSong = getPrevSong(model)
  end