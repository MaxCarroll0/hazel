fun (model, action) ->
  let (grid, emoji) = model in
  case action
  | SelectEmoji(new_emoji) => (grid, new_emoji)
  | StampEmoji(row, col) =>
    let updatedGrid = updateGrid(grid, row, col, emoji) in
    (updatedGrid, emoji)
  | FillRow(row) =>
    let filledGrid = List.map(grid, fun row_emojis -> if List.nth(row_emojis, 0) == row then List.map(row_emojis, fun _ -> emoji) else row_emojis) in
    (filledGrid, emoji)
  end