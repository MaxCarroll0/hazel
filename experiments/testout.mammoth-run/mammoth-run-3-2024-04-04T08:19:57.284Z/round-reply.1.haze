fun (model, action) ->
  case action
    | AddBooking(user, weekday, time) =>
      if bookingExists(model, (time, user, model.BookingID))
      then model
      else ((model.BookingFormData, (time, user, model.BookingID)::model.Bookings, model.BookingID + 1))
    | RemoveBooking(id) =>
      (model.BookingFormData, List.filter(fun (_, _, bookingID) -> bookingID != id, model.Bookings), model.BookingID)
    | UpdateForm(time, user) =>
      ((time, user), model.Bookings, model.BookingID)
  end