
fun (playList, playListAction) ->
  case playListAction
  | PlaySong(id) => (playList[0], Playing(id))
  | PauseCurrentSong => (playList[0], case playList[1] of Playing(id) => PausedOn(id) | _ => playList[1] end)
  | RemoveSong(id) => (List.filter(fun song_id -> song_id != id, playList[0]), playList[1])
  | AddSong(id) => (playList[0] @ [id], playList[1])
  end