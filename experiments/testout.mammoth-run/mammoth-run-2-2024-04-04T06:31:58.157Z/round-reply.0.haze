fun model, action ->
case action
| SelectEmoji(emoji) => let (grid, _, palette) = model in (grid, emoji, palette)
| StampEmoji((row, col)) => let (grid, emoji, palette) = model in (Grid.stamp(row, col, emoji, grid), emoji, palette)
| ClearCell((row, col)) => let (grid, emoji, palette) = model in (Grid.clear_cell(row, col, grid), emoji, palette)
| ClearGrid => let (_, emoji, palette) = model in (Grid.clear(), emoji, palette)
| FillRow(row) => let (grid, emoji, palette) = model in (Grid.fill_row(row, emoji, grid), emoji, palette)
end