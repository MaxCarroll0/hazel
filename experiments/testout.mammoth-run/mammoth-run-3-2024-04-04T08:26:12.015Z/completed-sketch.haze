# Update the Room Booking app model based on an action #

let update: (Model, Action) -> Model =
  fun model, action ->
  let formData, bookings, nextBookingID = model in
  case action
  | AddBooking(user, day, time) => ((day, time), user), bookings ++ [(day, time, user, nextBookingID)], nextBookingID + 1
  | CancelBooking(user, bookingID) => formData, rm_booking(user, bookingID, bookings), nextBookingID
  | ClearBookings => initFormState, [], nextBookingID
  end
in
