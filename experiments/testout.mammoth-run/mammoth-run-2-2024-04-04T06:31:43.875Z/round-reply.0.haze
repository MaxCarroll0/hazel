fun model, action ->
  case action
  | SelectEmoji(new_emoji) => (model.1, new_emoji, model.3)
  | StampEmoji(row, col) => (model.1 |> List.mapi(fun r, row_list -> if r == row then row_list |> List.mapi(fun c, _ -> if c == col then model.2 else _) else row_list), model.2, model.3)
  | ClearCell(row, col) => (model.1 |> List.mapi(fun r, row_list -> if r == row then row_list |> List.mapi(fun c, _ -> if c == col then "" else _) else row_list), model.2, model.3)
  | ClearGrid => (List.map(fun _ -> List.map(fun _ -> "") model.1) model.1, model.2, model.3)
  | FillRow(row) => (model.1 |> List.mapi(fun r, row_list -> if r == row then List.map(fun _ -> model.2) row_list else row_list), model.2, model.3)
  end