fun model, action ->
  case action
  | AddBooking(user, weekday, time) => if !bookingExists(model, (time, user, getBookingId(model))) then model else addBooking(model, (time, user, getBookingId(model)))
  | RemoveBooking(id) => removeBooking(model, id)
  | UpdateBookingForm(time, user) => updateBookingForm(model, (time, user))  
  end
