fun model, action ->
  case action
  | AddSong(id) => {model with songs = id::model.songs}
  | RemoveSong(id) => {model with songs = List.filter(fun sid -> sid != id, model.songs)}
  | TogglePlay => {model with state = if model.state == Playing then Paused else Playing}
  | SetVolume(vol) => {model with volume = vol}
  end