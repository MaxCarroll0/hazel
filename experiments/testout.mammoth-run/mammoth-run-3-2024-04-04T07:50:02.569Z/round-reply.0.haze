
fun (playlist, action) ->
  case action
  | PlaySong(id) => (playlist, Playing(id))
  | PauseCurrentSong => (playlist, PausedOn(id))
  | RemoveSong(id) => (List.remove(id, playlist), Playing(id))
  | AddSong(id) => (id::playlist, Playing(id))
  end