fun (model, action) ->
  case action
  | AddSong(song) => {model with songs = song :: model.songs}
  | RemoveSong(song) => {model with songs = List.filter((fun s -> s != song), model.songs)}
  | SetCurrentSong(song) => {model with current_song = song}
  | Pause => {model with is_playing = false}
  | Play => {model with is_playing = true}
  end