# Update the Room Booking app model based on an action #

let update: (Model, Action) -> Model =
  fun model, action ->
  case action
  | AddBooking(user, weekday, time) => let newID = model.3 + 1 in (initFormState, model.2 ++ [(weekday, time, user, newID)], newID)
  | CancelBooking(user, id) => (model.1, rm_booking(user, id, model.2), model.3)
  | ClearBookings => (model.1, [], model.3)
  end
in
