fun (model, action) ->
  case action
  | AddTodo => ("", model[1] ++ [""])
  | RemoveTodo(idx) => (model[0], List.remove_at(idx, model[1]))
  | ToggleTodo(idx) => (model[0], List.map_at(idx, fun x -> not x, model[1]))
  | UpdateBuffer(str) => (str, model[1])
  end