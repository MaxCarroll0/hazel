fun model, action ->
  case action
  | BookRoom(room_id) => { model with booked_rooms = room_id :: model.booked_rooms }
  | CancelBooking(room_id) => { model with booked_rooms = List.filter(fun id -> id != room_id, model.booked_rooms) } 
  | CheckIn(user_id, room_id) => { model with checked_in_users = (user_id, room_id) :: model.checked_in_users }
  | CheckOut(user_id) => { model with checked_in_users = List.filter(fun (id, _) -> id != user_id, model.checked_in_users) }
  end