fun (buffer, todos), action ->
  case action of
  | AddTodo =>
    if buffer $== "" then
      (buffer, todos)
    else
      ("", (buffer, false)::todos)
  | RemoveTodo(i) =>
    (buffer, List.remove(i, todos))
  | ToggleTodo(i) =>
    (buffer, List.mapi(fun idx, (desc, status) ->
      if idx == i then
        (desc, !status)
      else
        (desc, status)
    end, todos))
  | UpdateBuffer(new_buffer) =>
    (new_buffer, todos)
  end