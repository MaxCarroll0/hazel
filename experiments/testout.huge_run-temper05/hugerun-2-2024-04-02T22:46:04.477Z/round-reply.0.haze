
fun model, action ->
  case model, action of
  | (buffer, todos), AddTodo =>
    if buffer $== "" then
      model
    else
      ("", (buffer, false)::todos)
  | (buffer, todos), RemoveTodo(i) =>
    (buffer, List.remove(i, todos))
  | (buffer, todos), ToggleTodo(i) =>
    (buffer, List.mapi(fun idx, (desc, status) ->
      if idx == i then
        (desc, !status)
      else
        (desc, status)
    end, todos))
  | (_, todos), UpdateBuffer(new_buffer) =>
    (new_buffer, todos)
  end
in
