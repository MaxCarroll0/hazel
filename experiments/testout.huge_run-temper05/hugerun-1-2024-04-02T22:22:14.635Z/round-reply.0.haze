fun model, action ->
  case action
  | BookRoom(room) => { model with rooms = List.map (fun r -> if r.id == room.id then { r with booked = true } else r) model.rooms }
  | CancelBooking(room) => { model with rooms = List.map (fun r -> if r.id == room.id then { r with booked = false } else r) model.rooms }
  | CheckIn(user, room) => { model with rooms = List.map (fun r -> if r.id == room.id then { r with occupant = Some(user) } else r) model.rooms }
  | CheckOut(room) => { model with rooms = List.map (fun r -> if r.id == room.id then { r with occupant = None } else r) model.rooms }
  | AddRoom(room) => { model with rooms = room::model.rooms }
  | RemoveRoom(room) => { model with rooms = List.filter (fun r -> r.id != room.id) model.rooms }
  end