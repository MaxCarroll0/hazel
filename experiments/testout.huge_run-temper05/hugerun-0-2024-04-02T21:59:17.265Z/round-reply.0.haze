fun model, action ->
  case action
  | AddTodo => add(model)
  | RemoveTodo(idx) => List.remove(idx, snd(model))
  | ToggleTodo(idx) => List.map(fun (i, todo) -> if i == idx then (fst(todo), !snd(todo)) else todo, List.indexed(snd(model)))
  | UpdateBuffer(text) => (text, snd(model))
  end