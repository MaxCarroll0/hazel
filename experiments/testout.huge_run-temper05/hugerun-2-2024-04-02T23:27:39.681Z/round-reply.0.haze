fun model, action ->
  case action
  | AddSong(song_id) => let songs = get_songs(model) in
                        let updated_songs = List.merge((fun a, b -> a - b), songs, [song_id]) in
                        {model with songs = updated_songs}
  | RemoveSong(song_id) => let songs = get_songs(model) in
                           let updated_songs = List.filter_map((fun id -> if id == song_id then None else Some(id)), songs) in
                           {model with songs = updated_songs}
  | ChangeState(new_state) => {model with state = new_state}
  end