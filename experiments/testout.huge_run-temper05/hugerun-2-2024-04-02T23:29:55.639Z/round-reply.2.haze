fun (model, action) ->
  case action
    | AddBooking(user, weekday, time) =>
      if bookingExists(model, (time, user, snd(trd(model))))
      then model
      else ((fst(model), (time, user, snd(trd(model)))::snd(model), (fst(trd(model)), snd(trd(model)) + 1)))
    | DeleteBooking(id) =>
      (fst(model), List.filter(fun (_, _, bookingID) -> bookingID != id, snd(model)), trd(model))
    | UpdateForm(time, user) =>
      ((time, user), snd(model), trd(model))
  end