fun (model, action) ->
  case action
  | NoOp => model
  | Toggle(id) => { model with todos = toggle(id, model.todos) }
  | Remove(id) => { model with todos = remove(id, model.todos) }
  | Add => add(model)
  | UpdateNewTodoName(name) => { model with newTodoName = string_trim(name) }
  | ToggleAll => { model with todos = List.map((fun todo -> { todo with completed = !model.allChecked }), model.todos), allChecked = !model.allChecked }
  | ClearCompleted => { model with todos = List.filter((fun todo -> !todo.completed), model.todos) }
  end