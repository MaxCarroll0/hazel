fun model, action ->
  case action
  | SetEmoji(emoji) => {model with emoji = emoji}
  | SetColor(color) => {model with color = color}
  | Clear => {model with canvas = Canvas.empty()}
  | Undo => {model with history = List.tl(model.history)}
  | Redo => {model with history = model.redo::model.history}
  end