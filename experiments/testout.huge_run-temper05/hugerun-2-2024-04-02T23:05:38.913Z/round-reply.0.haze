
fun m, a ->
  case a
  | NoOp => m
  | Toggle(id) => {m with todos = toggle(id, m.todos)}
  | Remove(id) => {m with todos = remove(id, m.todos)}
  | Add => add(m)
  | UpdateInput(str) => {m with input = str}
  end