fun (playlist, action) ->
  let (songs, state) = playlist in
  case action of
    | PlaySong(id) => (songs, Playing(id))
    | PauseCurrentSong => 
        let newState = case state of 
          | Playing(id) => PausedOn(id) 
          | _ => state 
        in (songs, newState)
    | RemoveSong(id) => (List.filter(fun x -> x != id, songs), state)
    | AddSong(id) => ([id]@songs, state)
  end