fun (playlist, action) ->
    case action
    | PlaySong(id) => (playlist.0, Playing(id))
    | PauseCurrentSong => (playlist.0, match playlist.1 with | Playing(id) -> PausedOn(id) | _ -> playlist.1)
    | RemoveSong(id) => (List.filter(fun song_id -> song_id != id, playlist.0), playlist.1)
    | AddSong(id) => (id :: playlist.0, playlist.1)
    end