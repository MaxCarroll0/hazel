fun (playlist, action) ->
  case action
  | AddSong(id) => {playlist with songs = id::playlist.songs}
  | RemoveSong(id) => {playlist with songs = List.filter(fun song_id -> song_id != id, playlist.songs)}
  | SortSongs => {playlist with songs = List.sort(fun a b -> compare a b, playlist.songs)}
  | MergePlaylists(other) => {playlist with songs = List.merge(fun a b -> compare a b, playlist.songs, other.songs)}
  | ReversePlaylist => {playlist with songs = List.rev(playlist.songs)}
  | CombinePlaylists(other) => {playlist with songs = playlist.songs @ other.songs}
  end