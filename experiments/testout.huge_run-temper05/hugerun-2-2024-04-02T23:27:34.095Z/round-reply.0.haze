fun pl, action ->
  case action
  | AddSong(id) => PlayList(get_songs(pl) @ [id], get_state(pl))
  | RemoveSong(id) => PlayList(List.filter(fun song -> song != id, get_songs(pl)), get_state(pl))
  | Play => PlayList(get_songs(pl), Playing)
  | Pause => PlayList(get_songs(pl), Paused)
  | Stop => PlayList(get_songs(pl), Stopped)
  end