
fun model, action ->
    case action
    | SelectEmoji(emoji) => let (grid, _, palette) = model in (grid, emoji, palette)
    | StampEmoji((row, col)) => let (grid, emoji, palette) = model in (List.update(grid, row, List.update(List.nth(grid, row), col, emoji)), emoji, palette)
    | ClearCell((row, col)) => let (grid, emoji, palette) = model in (List.update(grid, row, List.update(List.nth(grid, row), col, "")), emoji, palette)
    | ClearGrid => let (_, emoji, palette) = model in (List.map(palette, fun _ -> List.map(palette, fun _ -> "")), emoji, palette)
    | FillRow(row) => let (grid, emoji, palette) = model in (List.update(grid, row, List.map(List.nth(grid, row), fun _ -> emoji)), emoji, palette)
    end
