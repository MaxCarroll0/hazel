fun model, action ->
  case action
  | AddSong(song) => List.rev_append(model, [song])
  | RemoveSong(song) => List.filter_map(fun s -> if s == song then None else Some(s), model)
  | SortPlaylist => List.sort(fun a, b -> a.id - b.id, model)
  | MergePlaylist(playlist) => List.merge(fun a, b -> a.id - b.id, model, playlist)
  | CombinePlaylist(playlist) => List.combine(model, playlist)
  | MapPlaylist(f) => List.concat_map(f, model)
  | FilterPlaylist(f) => List.filter_map(f, model)
  end