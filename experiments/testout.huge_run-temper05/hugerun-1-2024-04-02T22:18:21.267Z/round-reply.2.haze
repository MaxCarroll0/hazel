fun (playlist, action) ->
  case action
  | Play => {playlist with state = Playing}
  | Pause => {playlist with state = Paused}
  | AddSong(id) => {playlist with songs = id::playlist.songs}
  | RemoveSong(id) => {playlist with songs = List.filter(fun song_id -> song_id != id, playlist.songs)}