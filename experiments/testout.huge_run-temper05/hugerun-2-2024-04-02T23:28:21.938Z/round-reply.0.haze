fun model, action ->
  case action
    | AddSong(name, duration) =>
      let new_song = Song(name, duration) in
      PlayList(new_song::model.songs, model.current_song)
    | RemoveSong(name) =>
      let new_songs = List.filter(fun song -> song.name != name, model.songs) in
      PlayList(new_songs, model.current_song)
    | PlaySong(name) =>
      PlayList(model.songs, Some(name))
  end