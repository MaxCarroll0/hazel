fun m, a ->
  case a
  | AddTodo => if fst(m) $== "" then m else ( "", ((fst(m), false)::snd(m)))
  | RemoveTodo(n) => let (buffer, todos) = m in (buffer, List.remove_at(n, todos)) 
  | ToggleTodo(n) => let (buffer, todos) = m in (buffer, List.mapi(fun idx, (desc, status) -> if idx == n then (desc, !status) else (desc, status), todos)) 
  | UpdateBuffer(s) => (s, snd(m)) end