fun (model, action) ->
  case action
  | AddTodo => model :: AddTodo
  | RemoveTodo(i) => List.nth_remove(i, model)
  | ToggleTodo(i) => List.nth_set(i, !List.nth(i, model), model)
  | UpdateBuffer(str) => (str, model)
  end