fun (model, action) ->
  case action
  | AddTodo => 
      let (buffer, todos) = model in
      (buffer, Todo("", false)::todos)
  | RemoveTodo(idx) => 
      let (buffer, todos) = model in
      let todos' = List.remove_at(idx, todos) in
      (buffer, todos')
  | ToggleTodo(idx) => 
      let (buffer, todos) = model in
      let todos' = List.map_at(idx, Todo.toggle, todos) in
      (buffer, todos')
  | UpdateBuffer(text) =>
      let (_, todos) = model in
      (text, todos)   
  end
