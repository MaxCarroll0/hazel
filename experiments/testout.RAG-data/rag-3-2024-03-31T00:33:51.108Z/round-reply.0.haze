
fun model, action ->
  case action
  | AddBooking(user, weekday, weekdayBooking) =>
      if bookingExists(model, (weekday, user, weekdayBooking))
      then model
      else 
      let ((_, _, previousID), bookings, _) = model in
      let newID = previousID + 1 in
      ((weekday, user), [(weekday, user, newID)]::bookings, newID)
  | _ => model
end
