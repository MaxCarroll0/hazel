# Update the Room Booking app model based on an action #

let update: (Model, Action) -> Model =
  fun model, action ->
    case action 
    | AddBooking(user, weekday, time) => if !bookingExists(model, (user, weekday, time)) then model else addBooking(model, (user, weekday, time))
    | RemoveBooking(id) => removeBooking(model, id) 
    | ModifyBooking(id, user, weekday, time) => modifyBooking(model, id, (user, weekday, time))
    | NoAction => model
    end
in
