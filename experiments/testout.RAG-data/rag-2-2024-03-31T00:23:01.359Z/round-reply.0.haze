fun (input, todos), t ->
    case t
    | AddTodo => (input, todos)
    | RemoveTodo(idx) => (input, List.remove_at(todos, idx))
    | ToggleTodo(idx) => (input, List.mapi(fun i, (desc, done) -> if i == idx then (desc, !done) else (desc, done), todos))
    | UpdateBuffer(s) => (s, todos)
    end
