fun (model, action) ->
  case model of
    (grid, selected, emojis) => 
      case action
        | SelectEmoji(emoji) => (emoji, grid, emojis)
        | StampEmoji(row, col) =>
            let new_grid = updateGrid(grid, row, col, selected) in
            (new_grid, selected, emojis)
      end
  end