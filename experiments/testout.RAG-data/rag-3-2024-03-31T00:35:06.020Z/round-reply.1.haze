fun model, action ->
  case action
  | AddBooking(user, weekday, time) =>
      if not (bookingExists(model, (time, user))) then
        (model with { bookings = model.bookings @ [(time, user)]})
      else model
  | RemoveBooking(bookingId) =>
      let filtered_bookings = List.filter (fun (_, _, id) -> id != bookingId) model.bookings in
      (model with { bookings = filtered_bookings }) 
  end