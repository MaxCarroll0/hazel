# Update the Room Booking app model based on an action #

let update: (Model, Action) -> Model =
  fun (model, action) ->
    case action
    | AddBooking(user, weekday, time, am) => 
        let new_booking:Booking = (time, user, List.length(getBookings(model)) + 1) in
         if not (bookingExists(model, new_booking)) 
            then let (form, bookings, lastId) = model in 
                 (form, List.append(bookings, [new_booking]), lastId + 1)
            else model
    end
in
