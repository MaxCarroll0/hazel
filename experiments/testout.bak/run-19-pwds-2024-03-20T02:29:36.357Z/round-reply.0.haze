fun (model, action) ->
  case action
  | ChangePassword(p) =>
    let newStr = String.transform(p, [StripWhitespace, ToLower]) in
    let newPw = Password(newStr, strength_of(string_len(newStr))) in
    Model(newPw, model.criteria)
  | AddCriteria(c) => Model(model.password, c::model.criteria)
  | RemoveCriteria(c) =>
    let newCrit = List.filter(model.criteria, fun crit -> crit != c) in
    Model(model.password, newCrit)
  end
