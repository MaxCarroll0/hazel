let update: (Model, Action) -> Model =
  fun (model, action) ->
  case action
  | ClearCriteria => let (password, _, strength) = model in (password, [], strength)
  | AddCriterion(criteria) => let (password, criterias, strength) = model in (password, criterias ++ [criteria], strength)
  | RemoveCriterion(criteria) => let (password, criterias, strength) = model in (password, List.filter((!=) criteria, criterias), strength)
  | UpdatePassword(password) => let (_, criterias, _) = model in (password, criterias, calculateStrength(password, criterias))
  end
in