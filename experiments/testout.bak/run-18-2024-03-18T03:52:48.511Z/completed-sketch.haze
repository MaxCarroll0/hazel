# Update playlist based on action #
let update: (PlayList, PlayListAction) -> PlayList =
  fun (playlist, action) ->
  case action
    | Add(track) => track :: playlist
    | Remove() => 
      case playlist
        | [] => []
        | _::xs => xs
  end
    | Shuffle() => List.shuffle playlist
  end
in