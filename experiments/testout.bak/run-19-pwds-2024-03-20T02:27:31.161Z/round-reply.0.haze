
fun (model, action) ->
  case action
    | UpdatePassword(pwd) => (pwd, model.1, calculateStrength(pwd, model.1))
    | ClearCriteria => (model.0, [], Weak)
    | AddCriterion(c) => (model.0, c::model.1, calculateStrength(model.0, c::model.1))
    | RemoveCriterion(c) => (model.0, List.filter((!=) c, model.1), calculateStrength(model.0, List.filter((!=) c, model.1)))
  end
