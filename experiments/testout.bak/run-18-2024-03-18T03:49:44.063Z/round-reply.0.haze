fun (playlist, action) ->
  case action
  | PlaySong(id) => (playlist[0], Playing(id))
  | PauseCurrentSong => (playlist[0], PausedOn(CurrentSong()))
  | RemoveSong(id) => (filter(fun song -> song != id,playlist[0]), playlist[1])
  | AddSong(id) => (append(playlist[0], [id]), playlist[1])
  end
