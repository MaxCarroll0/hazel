fun (model, action) ->
case action
| AddBooking((user, weekday, timeofday)) =>
let nextID = mod(model.3 + 1, 1000) in
let newBooking = ((weekday, timeofday), user, nextID) in
(model.1, model.2::newBooking, nextID)
| CancelBooking((user, id)) => 
let remainingBookings = rm_booking(user, id, model.2) in
(model.1, remainingBookings, model.3)
| ClearBookings => (model.1, [], model.3)
end
