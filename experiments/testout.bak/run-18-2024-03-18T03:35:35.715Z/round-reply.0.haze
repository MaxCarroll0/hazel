fun model, action ->
  case action
  | AddTodo => (model.1, (model.2, false)::model.2)
  | RemoveTodo(i) => (model.1, List.remove(i, model.2))
  | ToggleTodo(i) => (model.1, List.update(i, fun td -> (td.1, not td.2), model.2))
  | UpdateBuffer(s) => (s, model.2)
  end