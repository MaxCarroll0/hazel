fun m, a ->
    case m, a
    | (form_data, bookings, last_id), AddBooking(user, weekday, timeofday) =>
        (form_data, [((weekday, timeofday), user, last_id + 1)]::bookings, last_id + 1)
    | (form_data, bookings, last_id), CancelBooking(user, booking_id) => 
        (form_data, rm_booking(user, booking_id, bookings), last_id)
    | (form_data, _, _), ClearBookings => 
        (form_data, [], last_id)
    end