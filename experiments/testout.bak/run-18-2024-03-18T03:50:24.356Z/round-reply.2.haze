fun (playlist, action) ->
    case action
      | Add(song) => song::playlist
      | Remove(song) => List.filter((fun s -> s != song), playlist)
      | Clear => []
    end