fun (model, action) ->
  case action of
  | AddSong(id) -> List.append(model, [id])
  | RemoveSong(id) -> List.filter(fun song -> song != id, model)
  | PlaySong(id) -> List.map(fun song -> if song == id then (song, Playing) else (song, NoSongSelected), model)
  | PauseCurrentSong -> List.map(fun (song, state) -> if state == Playing then (song, PausedOn(song)) else (song, state), model)
  end
