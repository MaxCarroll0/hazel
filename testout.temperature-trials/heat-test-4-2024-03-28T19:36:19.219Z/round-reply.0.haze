fun model, action ->
    case action
    | PlaySong(song_id) => (get_songs(model), Playing(song_id))
    | PauseCurrentSong => 
        case get_state(model) 
        | Playing(song_id) => (get_songs(model), PausedOn(song_id))
        | _ => model
        end
    | RemoveSong(song_id) => (List.filter(fun id -> id != song_id, get_songs(model)), get_state(model))
    | AddSong(song_id) => (song_id :: get_songs(model), get_state(model))
    end