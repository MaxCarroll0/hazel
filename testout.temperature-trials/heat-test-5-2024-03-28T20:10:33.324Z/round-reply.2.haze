fun (model, action) ->
  case action
  | AddSong(song) => { model with songs = song::model.songs }
  | DeleteSong(song) => { model with songs = List.filter((fun s -> s != song), model.songs) }
  | Play => { model with is_playing = true }
  | Pause => { model with is_playing = false }
  | Stop => { model with is_playing = false; current_song = None }
  | Next => let next_song = List.nth(model.songs, model.current_song + 1) in
            { model with current_song = Some(next_song) }
  | Prev => let prev_song = List.nth(model.songs, model.current_song - 1) in
            { model with current_song = Some(prev_song) }
  end