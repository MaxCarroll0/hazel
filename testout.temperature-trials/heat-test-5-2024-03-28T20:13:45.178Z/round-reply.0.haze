fun (playlist, action) -> 
  case action
    | PlaySong(id) => (playlist[0], Playing(id))
    | PauseCurrentSong => 
        case playlist[1]
          | Playing(id) => (playlist[0], PausedOn(id))
          | PausedOn(id) => (playlist[0], PausedOn(id))
          | NoSongSelected => playlist
        end
    | RemoveSong(id) => (List.filter((fun x -> x != id), playlist[0]), if playlist[1] == Playing(id) | PausedOn(id) then NoSongSelected else playlist[1] end)
    | AddSong(id) => (id::playlist[0], playlist[1])
  end