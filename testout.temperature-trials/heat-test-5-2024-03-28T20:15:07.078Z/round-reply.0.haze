
fun (playList, action) ->
  case action
    | PlaySong(id) => 
      let (songs, _) = playList in (songs, Playing(id))
    | PauseCurrentSong =>
      let (songs, state) = playList in 
      case state
        | Playing(id) => (songs, PausedOn(id))
        | _ => playList
      end
    | RemoveSong(id) => 
      let (songs, state) = playList in 
      (List.remove(id, songs), 
       case state 
         | Playing(id') if id == id' => NoSongSelected
         | PausedOn(id') if id == id' => NoSongSelected
         | _ => state
       end)
    | AddSong(id) => 
      let (songs, state) = playList in (List.append(songs, [id]), state)
  end