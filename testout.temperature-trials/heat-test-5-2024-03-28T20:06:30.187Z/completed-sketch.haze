# Update Playlist app model based on an action #

let update: (PlayList, PlayListAction) -> PlayList =
  fun (state, action) ->
  case action
  | AddSong(song) => {state with songs = song::state.songs}
  | RemoveSong(song) => {state with songs = List.filter((fun s -> s != song), state.songs)}
  | Play => {state with is_playing = true}
  | Pause => {state with is_playing = false}
  | Next => {state with current_song = state.current_song + 1}
  | Previous => {state with current_song = state.current_song - 1}
  end
in