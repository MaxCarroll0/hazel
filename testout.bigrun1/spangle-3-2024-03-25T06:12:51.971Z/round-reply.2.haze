fun (m, action) ->
  case action
  | AddBooking(user, weekday, timeOfDay) =>
    let (formData, bookings, nextId) = m in
    ((weekday, timeOfDay, ""), (weekday, timeOfDay, user, nextId)::bookings, nextId + 1)
  | CancelBooking(user, bookingId) =>
    let (formData, bookings, nextId) = m in
    (formData, List.filter (fun (_, _, id) -> id != bookingId, bookings), nextId)
  | ClearBookings =>
    let (formData, _, _) = m in
    (formData, [], 0)
  end