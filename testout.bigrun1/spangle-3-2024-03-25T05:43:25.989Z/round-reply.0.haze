fun (playlist, action) ->
    let (songs, state) = playlist in
    case action
    | PlaySong(id) => (songs, Playing(id))
    | PauseCurrentSong =>
        case state
        | Playing(id) => (songs, PausedOn(id))
        | _ => playlist 
    | RemoveSong(id) => (List.filter((fun song -> song != id), songs), state)
    | AddSong(id) => (id::songs, state) 
    end
