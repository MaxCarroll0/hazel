fun model, action ->
  case action
  | AddTodo => let (str, ts) = model in (str, (str, false)::ts)
  | RemoveTodo(i) => let (str, ts) = model in (str, List.filteri(fun idx, _ -> idx != i, ts))
  | ToggleTodo(i) => let (str, ts) = model in (str, List.mapi(fun idx, (t, b) -> if idx == i then (t, !b) else (t, b), ts))
  | UpdateBuffer(s) => let (str, ts) = model in (s, ts)
  end