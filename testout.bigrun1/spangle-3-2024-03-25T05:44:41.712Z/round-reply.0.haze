fun (playlist, action) ->
    case action 
      | PlaySong(id) => get_songs(playlist), Playing(id)
      | PauseCurrentSong => get_songs(playlist), PausedOn(pendingId)
      | RemoveSong(id) => get_songs(playlist).filter((_id) => _id != id), get_state(playlist)
      | AddSong(id) => get_songs(playlist).concat([id]), get_state(playlist)
    end
where pendingId = 
    case get_state(playlist)
      | Playing(id) => id
      | PausedOn(id) => id
      | _ => -1
    end