
fun m, a -> case a
| AddTodo =>
  let (buffer, todos) = m in
  if buffer == "" then m else (buffer, (buffer, false)::todos)
| RemoveTodo(idx) =>
  let (buffer, todos) = m in
  (buffer, List.remove(idx, todos))
| ToggleTodo(idx) =>
  let (buffer, todos) = m in
  (buffer, List.update(idx, fun (title, done) -> (title, !done), todos))
| UpdateBuffer(str) =>
  let (buffer, todos) = m in
  (str, todos)
end