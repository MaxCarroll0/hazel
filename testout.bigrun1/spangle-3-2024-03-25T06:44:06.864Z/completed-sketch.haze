# Update the EmojiPaint app model based on an action #

let update: (Model, Action) -> Model =
  fun model, action ->
  case action
  | Select(x, y) => {model with selected = Some(x, y)}
  | Paint(emoji) => 
      case model.selected with
      | Some(x, y) => {model with grid = MArray.set(model.grid, x, y, Some(emoji))}
      | None => model
      end
  | Clear => {model with grid = MArray.empty()}
in
