fun state, action ->
  case action
  | SelectEmoji(e) => (fst(state), e, snd(snd(state))) 
  | StampEmoji((row, col)) => let new_grid = List.mapi(fun r, row -> List.mapi(fun c, cell -> if r == row && c == col then snd(state) else cell) row) in (new_grid, snd(state), snd(snd(state)))
  | ClearCell((row, col)) => let new_grid = List.mapi(fun r, row -> List.mapi(fun c, cell -> if r == row && c == col then "" else cell) row) in (new_grid, snd(state), snd(snd(state)))
  | ClearGrid => ([[]], snd(state), snd(snd(state)))
  | _ => state 
  end