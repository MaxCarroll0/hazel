open Sexplib.Std;

[@deriving (show({with_path: false}), sexp, yojson)]
type t = {
  serialized_state: string,
  backup_text: string,
};

let empty = {
  serialized_state: "(0((selection((focus Left)(content())))(backpack())(relatives((siblings(((Grout((id 0)(sort Exp)(shape Convex))))()))(ancestors())))(caret Outer)))",
  backup_text: "",
};

let defaults = [
  {
    serialized_state: "(113526((selection((focus Left)(content())))(backpack())(relatives((siblings(((Tile((id 6)(label(let = in))(mold((out Exp)(in_(((sort Pat)(pad(true true)))((sort Exp)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1 2))(children(((Whitespace((id 113333)(content\" \")))(Tile((id 33)(label(int_lits))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Tile((id 40)(label(:))(mold((out Pat)(in_())(nibs(((shape(Concave((prec 10)(pad false))))(sort Pat))((shape(Concave((prec 10)(pad true))))(sort Typ))))))(shards(0))(children())))(Whitespace((id 113332)(content\" \")))(Tile((id 56)(label(Int))(mold((out Typ)(in_())(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0))(children())))(Whitespace((id 113331)(content\" \"))))((Whitespace((id 113330)(content\" \")))(Tile((id 75)(label(1))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113329)(content\" \"))))))))(Whitespace((id 94)(content\"\226\143\142\")))(Tile((id 122)(label(let = in))(mold((out Exp)(in_(((sort Pat)(pad(true true)))((sort Exp)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1 2))(children(((Whitespace((id 113337)(content\" \")))(Tile((id 194)(label(negation))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Whitespace((id 113336)(content\" \"))))((Whitespace((id 113335)(content\" \")))(Tile((id 229)(label(-))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 2)(pad false))))(sort Exp))))))(shards(0))(children())))(Tile((id 240)(label(1))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113334)(content\" \"))))))))(Whitespace((id 271)(content\"\226\143\142\")))(Tile((id 315)(label(let = in))(mold((out Exp)(in_(((sort Pat)(pad(true true)))((sort Exp)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1 2))(children(((Whitespace((id 113347)(content\" \")))(Tile((id 447)(label(arithmetic))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Whitespace((id 113346)(content\" \"))))((Whitespace((id 113345)(content\" \")))(Tile((id 498)(label(1))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113344)(content\" \")))(Tile((id 515)(label(*))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 3)(pad true))))(sort Exp))((shape(Concave((prec 3)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113343)(content\" \")))(Tile((id 532)(label(2))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113342)(content\" \")))(Tile((id 566)(label(+))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 4)(pad true))))(sort Exp))((shape(Concave((prec 4)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113341)(content\" \")))(Tile((id 602)(label(8))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113340)(content\" \")))(Tile((id 623)(label(/))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 3)(pad true))))(sort Exp))((shape(Concave((prec 3)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113339)(content\" \")))(Tile((id 644)(label(4))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113338)(content\" \"))))))))(Whitespace((id 705)(content\"\226\143\142\")))(Tile((id 789)(label(let = in))(mold((out Exp)(in_(((sort Pat)(pad(true true)))((sort Exp)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1 2))(children(((Whitespace((id 113365)(content\" \")))(Tile((id 1119)(label(int_comparison))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Whitespace((id 113364)(content\" \"))))((Whitespace((id 113363)(content\" \")))(Tile((id 1186)(label(\"(\"\")\"))(mold((out Exp)(in_(((sort Exp)(pad(false false)))))(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0 1))(children(((Tile((id 1258)(label(10))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113361)(content\" \")))(Tile((id 1334)(label(==))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 7)(pad true))))(sort Exp))((shape(Concave((prec 7)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113360)(content\" \")))(Tile((id 1412)(label(10))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Tile((id 1440)(label(,))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Exp))((shape(Concave((prec 11)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113359)(content\" \")))(Tile((id 1494)(label(1))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113358)(content\" \")))(Tile((id 1550)(label(<))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 7)(pad true))))(sort Exp))((shape(Concave((prec 7)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113357)(content\" \")))(Tile((id 1608)(label(2))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Tile((id 1639)(label(,))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Exp))((shape(Concave((prec 11)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113356)(content\" \")))(Tile((id 1699)(label(2))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113355)(content\" \")))(Tile((id 1793)(label(<=))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 7)(pad true))))(sort Exp))((shape(Concave((prec 7)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113354)(content\" \")))(Tile((id 1857)(label(3))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Tile((id 1891)(label(,))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Exp))((shape(Concave((prec 11)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113353)(content\" \")))(Tile((id 1957)(label(3))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113352)(content\" \")))(Tile((id 2025)(label(>))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 7)(pad true))))(sort Exp))((shape(Concave((prec 7)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113351)(content\" \")))(Tile((id 2095)(label(2))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Tile((id 2132)(label(,))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Exp))((shape(Concave((prec 11)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113350)(content\" \")))(Tile((id 2204)(label(2))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113349)(content\" \")))(Tile((id 2316)(label(>=))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 7)(pad true))))(sort Exp))((shape(Concave((prec 7)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113348)(content\" \")))(Tile((id 2392)(label(1))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children()))))))))(Whitespace((id 113362)(content\" \"))))))))(Whitespace((id 2543)(content\"\226\143\142\")))(Whitespace((id 2582)(content\"\226\143\142\")))(Tile((id 2738)(label(let = in))(mold((out Exp)(in_(((sort Pat)(pad(true true)))((sort Exp)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1 2))(children(((Whitespace((id 113370)(content\" \")))(Tile((id 3178)(label(float_lits))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Tile((id 3259)(label(:))(mold((out Pat)(in_())(nibs(((shape(Concave((prec 10)(pad false))))(sort Pat))((shape(Concave((prec 10)(pad true))))(sort Typ))))))(shards(0))(children())))(Whitespace((id 113369)(content\" \")))(Tile((id 3505)(label(Float))(mold((out Typ)(in_())(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0))(children())))(Whitespace((id 113368)(content\" \"))))((Whitespace((id 113367)(content\" \")))(Tile((id 3758)(label(1.5))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113366)(content\" \"))))))))(Whitespace((id 3888)(content\"\226\143\142\")))(Tile((id 4064)(label(let = in))(mold((out Exp)(in_(((sort Pat)(pad(true true)))((sort Exp)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1 2))(children(((Whitespace((id 113380)(content\" \")))(Tile((id 4604)(label(float_artih))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Whitespace((id 113379)(content\" \"))))((Whitespace((id 113378)(content\" \")))(Tile((id 4834)(label(1.))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113377)(content\" \")))(Tile((id 4979)(label(*.))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 3)(pad true))))(sort Exp))((shape(Concave((prec 3)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113376)(content\" \")))(Tile((id 5126)(label(2.))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113375)(content\" \")))(Tile((id 5277)(label(+.))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 4)(pad true))))(sort Exp))((shape(Concave((prec 4)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113374)(content\" \")))(Tile((id 5430)(label(8.))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113373)(content\" \")))(Tile((id 5587)(label(/.))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 3)(pad true))))(sort Exp))((shape(Concave((prec 3)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113372)(content\" \")))(Tile((id 5746)(label(4.))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113371)(content\" \"))))))))(Whitespace((id 5906)(content\"\226\143\142\")))(Tile((id 6122)(label(let = in))(mold((out Exp)(in_(((sort Pat)(pad(true true)))((sort Exp)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1 2))(children(((Whitespace((id 113398)(content\" \")))(Tile((id 7057)(label(float_comparison))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Whitespace((id 113397)(content\" \"))))((Whitespace((id 113396)(content\" \")))(Tile((id 7223)(label(\"(\"\")\"))(mold((out Exp)(in_(((sort Exp)(pad(false false)))))(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0 1))(children(((Tile((id 7451)(label(10.))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113394)(content\" \")))(Tile((id 7685)(label(==.))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 7)(pad true))))(sort Exp))((shape(Concave((prec 7)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113393)(content\" \")))(Tile((id 7921)(label(10.))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Tile((id 7982)(label(,))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Exp))((shape(Concave((prec 11)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113392)(content\" \")))(Tile((id 8162)(label(1.))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113391)(content\" \")))(Tile((id 8346)(label(<.))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 5)(pad true))))(sort Exp))((shape(Concave((prec 5)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113390)(content\" \")))(Tile((id 8532)(label(2.))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Tile((id 8596)(label(,))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Exp))((shape(Concave((prec 11)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113389)(content\" \")))(Tile((id 8785)(label(2.))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113388)(content\" \")))(Tile((id 9043)(label(<=.))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 7)(pad true))))(sort Exp))((shape(Concave((prec 7)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113387)(content\" \")))(Tile((id 9238)(label(3.))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Tile((id 9305)(label(,))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Exp))((shape(Concave((prec 11)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113386)(content\" \")))(Tile((id 9503)(label(3.))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113385)(content\" \")))(Tile((id 9705)(label(>.))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 5)(pad true))))(sort Exp))((shape(Concave((prec 5)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113384)(content\" \")))(Tile((id 9909)(label(2.))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Tile((id 9979)(label(,))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Exp))((shape(Concave((prec 11)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113383)(content\" \")))(Tile((id 10186)(label(2.))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113382)(content\" \")))(Tile((id 10468)(label(>=.))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 7)(pad true))))(sort Exp))((shape(Concave((prec 7)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113381)(content\" \")))(Tile((id 10681)(label(1.))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children()))))))))(Whitespace((id 113395)(content\" \"))))))))(Whitespace((id 10964)(content\"\226\143\142\")))(Whitespace((id 11036)(content\"\226\143\142\")))(Tile((id 11324)(label(let = in))(mold((out Exp)(in_(((sort Pat)(pad(true true)))((sort Exp)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1 2))(children(((Whitespace((id 113405)(content\" \")))(Tile((id 11981)(label(booleans))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Tile((id 12128)(label(:))(mold((out Pat)(in_())(nibs(((shape(Concave((prec 10)(pad false))))(sort Pat))((shape(Concave((prec 10)(pad true))))(sort Typ))))))(shards(0))(children())))(Whitespace((id 113404)(content\" \")))(Tile((id 12202)(label(\"(\"\")\"))(mold((out Typ)(in_(((sort Typ)(pad(false false)))))(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0 1))(children(((Tile((id 12572)(label(Bool))(mold((out Typ)(in_())(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0))(children())))(Tile((id 12648)(label(,))(mold((out Typ)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Typ))((shape(Concave((prec 11)(pad true))))(sort Typ))))))(shards(0))(children())))(Whitespace((id 113402)(content\" \")))(Tile((id 13023)(label(Bool))(mold((out Typ)(in_())(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0))(children()))))))))(Whitespace((id 113403)(content\" \"))))((Whitespace((id 113401)(content\" \")))(Tile((id 13322)(label(\"(\"\")\"))(mold((out Exp)(in_(((sort Exp)(pad(false false)))))(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0 1))(children(((Tile((id 13707)(label(true))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Tile((id 13786)(label(,))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Exp))((shape(Concave((prec 11)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113399)(content\" \")))(Tile((id 14254)(label(false))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children()))))))))(Whitespace((id 113400)(content\" \"))))))))(Whitespace((id 14565)(content\"\226\143\142\")))(Tile((id 14881)(label(let = in))(mold((out Exp)(in_(((sort Pat)(pad(true true)))((sort Exp)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1 2))(children(((Whitespace((id 113423)(content\" \")))(Tile((id 15921)(label(conditionals))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Whitespace((id 113422)(content\" \"))))((Whitespace((id 16081)(content\"\226\143\142\")))(Tile((id 16405)(label(let = in))(mold((out Exp)(in_(((sort Pat)(pad(true true)))((sort Exp)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1 2))(children(((Whitespace((id 113421)(content\" \")))(Tile((id 16487)(label(\"(\"\")\"))(mold((out Pat)(in_(((sort Pat)(pad(false false)))))(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0 1))(children(((Tile((id 16651)(label(x))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Tile((id 16735)(label(,))(mold((out Pat)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Pat))((shape(Concave((prec 11)(pad true))))(sort Pat))))))(shards(0))(children())))(Whitespace((id 113419)(content\" \")))(Tile((id 16901)(label(y))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children()))))))))(Whitespace((id 113420)(content\" \"))))((Whitespace((id 113418)(content\" \")))(Tile((id 17232)(label(\"(\"\")\"))(mold((out Exp)(in_(((sort Exp)(pad(false false)))))(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0 1))(children(((Tile((id 17402)(label(2))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113416)(content\" \")))(Tile((id 17574)(label(+))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 4)(pad true))))(sort Exp))((shape(Concave((prec 4)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113415)(content\" \")))(Tile((id 17748)(label(2))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Tile((id 17837)(label(,))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Exp))((shape(Concave((prec 11)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113414)(content\" \")))(Tile((id 18013)(label(3))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113413)(content\" \")))(Tile((id 18191)(label(+))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 4)(pad true))))(sort Exp))((shape(Concave((prec 4)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113412)(content\" \")))(Tile((id 18371)(label(3))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children()))))))))(Whitespace((id 113417)(content\" \"))))))))(Whitespace((id 18730)(content\"\226\143\142\")))(Tile((id 19003)(label(if then else))(mold((out Exp)(in_(((sort Exp)(pad(true true)))((sort Exp)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 12)(pad true))))(sort Exp))))))(shards(0 1 2))(children(((Whitespace((id 113410)(content\" \")))(Tile((id 19187)(label(y))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113409)(content\" \")))(Tile((id 19373)(label(>))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 7)(pad true))))(sort Exp))((shape(Concave((prec 7)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113408)(content\" \")))(Tile((id 19561)(label(x))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113407)(content\" \"))))((Whitespace((id 113406)(content\" \")))(Tile((id 20225)(label(1))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 20321)(content\"\226\143\142\"))))))))(Whitespace((id 113411)(content\" \")))(Tile((id 20995)(label(2))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 21092)(content\"\226\143\142\"))))))))(Whitespace((id 21382)(content\"\226\143\142\")))(Whitespace((id 21479)(content\"\226\143\142\")))(Tile((id 21867)(label(let = in))(mold((out Exp)(in_(((sort Pat)(pad(true true)))((sort Exp)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1 2))(children(((Whitespace((id 113434)(content\" \")))(Tile((id 22553)(label(tuples))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Tile((id 22750)(label(:))(mold((out Pat)(in_())(nibs(((shape(Concave((prec 10)(pad false))))(sort Pat))((shape(Concave((prec 10)(pad true))))(sort Typ))))))(shards(0))(children())))(Whitespace((id 113433)(content\" \")))(Tile((id 22849)(label(\"(\"\")\"))(mold((out Typ)(in_(((sort Typ)(pad(false false)))))(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0 1))(children(((Tile((id 23245)(label(Int))(mold((out Typ)(in_())(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0))(children())))(Tile((id 23346)(label(,))(mold((out Typ)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Typ))((shape(Concave((prec 11)(pad true))))(sort Typ))))))(shards(0))(children())))(Whitespace((id 113431)(content\" \")))(Tile((id 23846)(label(Bool))(mold((out Typ)(in_())(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0))(children())))(Tile((id 23948)(label(,))(mold((out Typ)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Typ))((shape(Concave((prec 11)(pad true))))(sort Typ))))))(shards(0))(children())))(Whitespace((id 113430)(content\" \")))(Tile((id 24049)(label(\"(\"\")\"))(mold((out Typ)(in_(((sort Typ)(pad(false false)))))(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0 1))(children(((Tile((id 24554)(label(Bool))(mold((out Typ)(in_())(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0))(children())))(Tile((id 24657)(label(,))(mold((out Typ)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Typ))((shape(Concave((prec 11)(pad true))))(sort Typ))))))(shards(0))(children())))(Whitespace((id 113429)(content\" \")))(Tile((id 25065)(label(Int))(mold((out Typ)(in_())(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0))(children())))))))))))))(Whitespace((id 113432)(content\" \"))))((Whitespace((id 113428)(content\" \")))(Tile((id 25572)(label(\"(\"\")\"))(mold((out Exp)(in_(((sort Exp)(pad(false false)))))(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0 1))(children(((Tile((id 25780)(label(1))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Tile((id 25886)(label(,))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Exp))((shape(Concave((prec 11)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113426)(content\" \")))(Tile((id 26411)(label(true))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Tile((id 26518)(label(,))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Exp))((shape(Concave((prec 11)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113425)(content\" \")))(Tile((id 26624)(label(\"(\"\")\"))(mold((out Exp)(in_(((sort Exp)(pad(false false)))))(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0 1))(children(((Tile((id 27260)(label(false))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Tile((id 27368)(label(,))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Exp))((shape(Concave((prec 11)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113424)(content\" \")))(Tile((id 27582)(label(3))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))))))))))))(Whitespace((id 113427)(content\" \"))))))))(Whitespace((id 28114)(content\"\226\143\142\")))(Tile((id 28546)(label(let = in))(mold((out Exp)(in_(((sort Pat)(pad(true true)))((sort Exp)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1 2))(children(((Whitespace((id 113441)(content\" \")))(Tile((id 28655)(label(\"(\"\")\"))(mold((out Pat)(in_(((sort Pat)(pad(false false)))))(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0 1))(children(((Tile((id 28873)(label(a))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Tile((id 28984)(label(,))(mold((out Pat)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Pat))((shape(Concave((prec 11)(pad true))))(sort Pat))))))(shards(0))(children())))(Whitespace((id 113439)(content\" \")))(Tile((id 29204)(label(b))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Tile((id 29316)(label(,))(mold((out Pat)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Pat))((shape(Concave((prec 11)(pad true))))(sort Pat))))))(shards(0))(children())))(Whitespace((id 113438)(content\" \")))(Tile((id 29427)(label(\"(\"\")\"))(mold((out Pat)(in_(((sort Pat)(pad(false false)))))(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0 1))(children(((Tile((id 29649)(label(c))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Tile((id 29762)(label(,))(mold((out Pat)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Pat))((shape(Concave((prec 11)(pad true))))(sort Pat))))))(shards(0))(children())))(Whitespace((id 113437)(content\" \")))(Tile((id 29986)(label(d))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))))))))))))(Whitespace((id 113440)(content\" \"))))((Whitespace((id 113436)(content\" \")))(Tile((id 31227)(label(tuples))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113435)(content\" \"))))))))(Whitespace((id 31570)(content\"\226\143\142\")))(Whitespace((id 31685)(content\"\226\143\142\")))(Tile((id 32145)(label(let = in))(mold((out Exp)(in_(((sort Pat)(pad(true true)))((sort Exp)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1 2))(children(((Whitespace((id 113457)(content\" \")))(Tile((id 32377)(label(y))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Tile((id 32610)(label(:))(mold((out Pat)(in_())(nibs(((shape(Concave((prec 10)(pad false))))(sort Pat))((shape(Concave((prec 10)(pad true))))(sort Typ))))))(shards(0))(children())))(Whitespace((id 113456)(content\" \")))(Tile((id 32727)(label(\"(\"\")\"))(mold((out Typ)(in_(((sort Typ)(pad(false false)))))(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0 1))(children(((Tile((id 33195)(label(Int))(mold((out Typ)(in_())(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0))(children())))(Tile((id 33314)(label(,))(mold((out Typ)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Typ))((shape(Concave((prec 11)(pad true))))(sort Typ))))))(shards(0))(children())))(Whitespace((id 113454)(content\" \")))(Tile((id 33786)(label(Int))(mold((out Typ)(in_())(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0))(children())))(Tile((id 33906)(label(,))(mold((out Typ)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Typ))((shape(Concave((prec 11)(pad true))))(sort Typ))))))(shards(0))(children())))(Whitespace((id 113453)(content\" \")))(Tile((id 34382)(label(Int))(mold((out Typ)(in_())(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0))(children()))))))))(Whitespace((id 113455)(content\" \")))(Tile((id 34860)(label(->))(mold((out Typ)(in_())(nibs(((shape(Concave((prec 6)(pad true))))(sort Typ))((shape(Concave((prec 6)(pad true))))(sort Typ))))))(shards(0))(children())))(Whitespace((id 113452)(content\" \")))(Tile((id 35344)(label(Int))(mold((out Typ)(in_())(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0))(children())))(Whitespace((id 113451)(content\" \"))))((Whitespace((id 35586)(content\"\226\143\142\")))(Tile((id 36074)(label(fun ->))(mold((out Exp)(in_(((sort Pat)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1))(children(((Whitespace((id 113449)(content\" \")))(Tile((id 36197)(label(\"(\"\")\"))(mold((out Pat)(in_(((sort Pat)(pad(false false)))))(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0 1))(children(((Tile((id 36443)(label(m))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Tile((id 36568)(label(,))(mold((out Pat)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Pat))((shape(Concave((prec 11)(pad true))))(sort Pat))))))(shards(0))(children())))(Whitespace((id 113447)(content\" \")))(Tile((id 36816)(label(x))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Tile((id 36942)(label(,))(mold((out Pat)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Pat))((shape(Concave((prec 11)(pad true))))(sort Pat))))))(shards(0))(children())))(Whitespace((id 113446)(content\" \")))(Tile((id 37192)(label(b))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children()))))))))(Whitespace((id 113448)(content\" \"))))))))(Whitespace((id 113450)(content\" \")))(Tile((id 37945)(label(m))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113445)(content\" \")))(Tile((id 38201)(label(*))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 3)(pad true))))(sort Exp))((shape(Concave((prec 3)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113444)(content\" \")))(Tile((id 38459)(label(x))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113443)(content\" \")))(Tile((id 38719)(label(+))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 4)(pad true))))(sort Exp))((shape(Concave((prec 4)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113442)(content\" \")))(Tile((id 38981)(label(b))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 39112)(content\"\226\143\142\"))))))))(Whitespace((id 39504)(content\"\226\143\142\")))(Whitespace((id 39635)(content\"\226\143\142\")))(Tile((id 40159)(label(let = in))(mold((out Exp)(in_(((sort Pat)(pad(true true)))((sort Exp)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1 2))(children(((Whitespace((id 113474)(content\" \")))(Tile((id 42667)(label(double_recursively))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Tile((id 42932)(label(:))(mold((out Pat)(in_())(nibs(((shape(Concave((prec 10)(pad false))))(sort Pat))((shape(Concave((prec 10)(pad true))))(sort Typ))))))(shards(0))(children())))(Whitespace((id 113473)(content\" \")))(Tile((id 43464)(label(Int))(mold((out Typ)(in_())(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0))(children())))(Whitespace((id 113472)(content\" \")))(Tile((id 43867)(label(->))(mold((out Typ)(in_())(nibs(((shape(Concave((prec 6)(pad true))))(sort Typ))((shape(Concave((prec 6)(pad true))))(sort Typ))))))(shards(0))(children())))(Whitespace((id 113471)(content\" \")))(Tile((id 44407)(label(Int))(mold((out Typ)(in_())(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0))(children())))(Whitespace((id 113470)(content\" \"))))((Whitespace((id 44677)(content\"\226\143\142\")))(Tile((id 45221)(label(fun ->))(mold((out Exp)(in_(((sort Pat)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1))(children(((Whitespace((id 113469)(content\" \")))(Tile((id 45495)(label(n))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Whitespace((id 113468)(content\" \"))))))))(Whitespace((id 45908)(content\"\226\143\142\")))(Tile((id 46322)(label(if then else))(mold((out Exp)(in_(((sort Exp)(pad(true true)))((sort Exp)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 12)(pad true))))(sort Exp))))))(shards(0 1 2))(children(((Whitespace((id 113466)(content\" \")))(Tile((id 46600)(label(n))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113465)(content\" \")))(Tile((id 47021)(label(==))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 7)(pad true))))(sort Exp))((shape(Concave((prec 7)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113464)(content\" \")))(Tile((id 47303)(label(0))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113463)(content\" \"))))((Whitespace((id 113462)(content\" \")))(Tile((id 48296)(label(0))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 48439)(content\"\226\143\142\"))))))))(Whitespace((id 113467)(content\" \")))(Tile((id 51890)(label(double_recursively))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Tile((id 51891)(label(\"(\"\")\"))(mold((out Exp)(in_(((sort Exp)(pad(false false)))))(nibs(((shape(Concave((prec 1)(pad false))))(sort Exp))((shape Convex)(sort Exp))))))(shards(0 1))(children(((Tile((id 52179)(label(n))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113460)(content\" \")))(Tile((id 52469)(label(-))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 4)(pad true))))(sort Exp))((shape(Concave((prec 4)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113459)(content\" \")))(Tile((id 52761)(label(1))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children()))))))))(Whitespace((id 113461)(content\" \")))(Tile((id 53199)(label(+))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 4)(pad true))))(sort Exp))((shape(Concave((prec 4)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113458)(content\" \")))(Tile((id 53495)(label(2))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 53643)(content\"\226\143\142\"))))))))(Whitespace((id 54086)(content\"\226\143\142\")))(Whitespace((id 54234)(content\"\226\143\142\")))(Tile((id 54826)(label(let = in))(mold((out Exp)(in_(((sort Pat)(pad(true true)))((sort Exp)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1 2))(children(((Whitespace((id 113479)(content\" \")))(Tile((id 56465)(label(empty_list))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Tile((id 56764)(label(:))(mold((out Pat)(in_())(nibs(((shape(Concave((prec 10)(pad false))))(sort Pat))((shape(Concave((prec 10)(pad true))))(sort Typ))))))(shards(0))(children())))(Whitespace((id 113478)(content\" \")))(Tile((id 56914)(label([ ]))(mold((out Typ)(in_(((sort Typ)(pad(false false)))))(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0 1))(children(((Tile((id 57514)(label(Int))(mold((out Typ)(in_())(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0))(children()))))))))(Whitespace((id 113477)(content\" \"))))((Whitespace((id 113476)(content\" \")))(Tile((id 58569)(label(nil))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113475)(content\" \"))))))))(Whitespace((id 59026)(content\"\226\143\142\")))(Tile((id 59638)(label(let = in))(mold((out Exp)(in_(((sort Pat)(pad(true true)))((sort Exp)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1 2))(children(((Whitespace((id 113484)(content\" \")))(Tile((id 61948)(label(non_empty_list))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Tile((id 62257)(label(:))(mold((out Pat)(in_())(nibs(((shape(Concave((prec 10)(pad false))))(sort Pat))((shape(Concave((prec 10)(pad true))))(sort Typ))))))(shards(0))(children())))(Whitespace((id 113483)(content\" \")))(Tile((id 62412)(label([ ]))(mold((out Typ)(in_(((sort Typ)(pad(false false)))))(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0 1))(children(((Tile((id 63032)(label(Int))(mold((out Typ)(in_())(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0))(children()))))))))(Whitespace((id 113482)(content\" \"))))((Whitespace((id 113481)(content\" \")))(Tile((id 63808)(label(1))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Tile((id 64125)(label(::))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 5)(pad false))))(sort Exp))((shape(Concave((prec 5)(pad false))))(sort Exp))))))(shards(0))(children())))(Tile((id 64283)(label(2))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Tile((id 64600)(label(::))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 5)(pad false))))(sort Exp))((shape(Concave((prec 5)(pad false))))(sort Exp))))))(shards(0))(children())))(Tile((id 64758)(label(3))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Tile((id 65075)(label(::))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 5)(pad false))))(sort Exp))((shape(Concave((prec 5)(pad false))))(sort Exp))))))(shards(0))(children())))(Tile((id 65547)(label(nil))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113480)(content\" \"))))))))(Whitespace((id 66019)(content\"\226\143\142\")))(Tile((id 66651)(label(let = in))(mold((out Exp)(in_(((sort Pat)(pad(true true)))((sort Exp)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1 2))(children(((Whitespace((id 113491)(content\" \")))(Tile((id 68877)(label(list_literals))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Tile((id 69196)(label(:))(mold((out Pat)(in_())(nibs(((shape(Concave((prec 10)(pad false))))(sort Pat))((shape(Concave((prec 10)(pad true))))(sort Typ))))))(shards(0))(children())))(Whitespace((id 113490)(content\" \")))(Tile((id 69356)(label([ ]))(mold((out Typ)(in_(((sort Typ)(pad(false false)))))(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0 1))(children(((Tile((id 69996)(label(Int))(mold((out Typ)(in_())(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0))(children()))))))))(Whitespace((id 113489)(content\" \"))))((Whitespace((id 113488)(content\" \")))(Tile((id 70635)(label([ ]))(mold((out Exp)(in_(((sort Exp)(pad(false false)))))(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0 1))(children(((Tile((id 70959)(label(1))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Tile((id 71123)(label(,))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Exp))((shape(Concave((prec 11)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113486)(content\" \")))(Tile((id 71449)(label(2))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Tile((id 71614)(label(,))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 11)(pad false))))(sort Exp))((shape(Concave((prec 11)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113485)(content\" \")))(Tile((id 71942)(label(3))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children()))))))))(Whitespace((id 113487)(content\" \"))))))))(Whitespace((id 72597)(content\"\226\143\142\")))(Tile((id 73257)(label(let = in))(mold((out Exp)(in_(((sort Pat)(pad(true true)))((sort Exp)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1 2))(children(((Whitespace((id 113507)(content\" \")))(Tile((id 74419)(label(length))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Tile((id 74752)(label(:))(mold((out Pat)(in_())(nibs(((shape(Concave((prec 10)(pad false))))(sort Pat))((shape(Concave((prec 10)(pad true))))(sort Typ))))))(shards(0))(children())))(Whitespace((id 113506)(content\" \")))(Tile((id 74919)(label([ ]))(mold((out Typ)(in_(((sort Typ)(pad(false false)))))(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0 1))(children(((Tile((id 75587)(label(Int))(mold((out Typ)(in_())(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0))(children()))))))))(Whitespace((id 113505)(content\" \")))(Tile((id 76257)(label(->))(mold((out Typ)(in_())(nibs(((shape(Concave((prec 6)(pad true))))(sort Typ))((shape(Concave((prec 6)(pad true))))(sort Typ))))))(shards(0))(children())))(Whitespace((id 113504)(content\" \")))(Tile((id 76933)(label(Int))(mold((out Typ)(in_())(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0))(children())))(Whitespace((id 113503)(content\" \"))))((Whitespace((id 77271)(content\"\226\143\142\")))(Tile((id 77951)(label(fun ->))(mold((out Exp)(in_(((sort Pat)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1))(children(((Whitespace((id 113502)(content\" \")))(Tile((id 78464)(label(xs))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Whitespace((id 113501)(content\" \"))))))))(Whitespace((id 78979)(content\"\226\143\142\")))(Tile((id 79839)(label(case end))(mold((out Exp)(in_(((sort Rul)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0 1))(children(((Whitespace((id 113500)(content\" \")))(Tile((id 80358)(label(xs))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 80359)(content\"\226\143\142\")))(Tile((id 80531)(label(| =>))(mold((out Rul)(in_(((sort Pat)(pad(true true)))))(nibs(((shape(Concave((prec 17)(pad true))))(sort Exp))((shape(Concave((prec 17)(pad true))))(sort Exp))))))(shards(0 1))(children(((Whitespace((id 113498)(content\" \")))(Tile((id 81399)(label(nil))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Whitespace((id 113497)(content\" \"))))))))(Whitespace((id 113499)(content\" \")))(Tile((id 82274)(label(0))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 82275)(content\"\226\143\142\")))(Tile((id 82450)(label(| =>))(mold((out Rul)(in_(((sort Pat)(pad(true true)))))(nibs(((shape(Concave((prec 17)(pad true))))(sort Exp))((shape(Concave((prec 17)(pad true))))(sort Exp))))))(shards(0 1))(children(((Whitespace((id 113495)(content\" \")))(Tile((id 83156)(label(hd))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Tile((id 83513)(label(::))(mold((out Pat)(in_())(nibs(((shape(Concave((prec 5)(pad false))))(sort Pat))((shape(Concave((prec 5)(pad false))))(sort Pat))))))(shards(0))(children())))(Tile((id 83868)(label(tl))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Whitespace((id 113494)(content\" \"))))))))(Whitespace((id 113496)(content\" \")))(Tile((id 84758)(label(1))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 113493)(content\" \")))(Tile((id 85118)(label(+))(mold((out Exp)(in_())(nibs(((shape(Concave((prec 4)(pad true))))(sort Exp))((shape(Concave((prec 4)(pad true))))(sort Exp))))))(shards(0))(children())))(Whitespace((id 113492)(content\" \")))(Tile((id 86385)(label(length))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Tile((id 86386)(label(\"(\"\")\"))(mold((out Exp)(in_(((sort Exp)(pad(false false)))))(nibs(((shape(Concave((prec 1)(pad false))))(sort Exp))((shape Convex)(sort Exp))))))(shards(0 1))(children(((Tile((id 86929)(label(tl))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children()))))))))(Whitespace((id 87289)(content\"\226\143\142\"))))))))(Whitespace((id 88192)(content\"\226\143\142\"))))))))(Whitespace((id 88734)(content\"\226\143\142\")))(Tile((id 89458)(label(let = in))(mold((out Exp)(in_(((sort Pat)(pad(true true)))((sort Exp)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1 2))(children(((Whitespace((id 113524)(content\" \")))(Tile((id 94190)(label(has_at_least_two_elements))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Tile((id 94555)(label(:))(mold((out Pat)(in_())(nibs(((shape(Concave((prec 10)(pad false))))(sort Pat))((shape(Concave((prec 10)(pad true))))(sort Typ))))))(shards(0))(children())))(Whitespace((id 113523)(content\" \")))(Tile((id 94738)(label([ ]))(mold((out Typ)(in_(((sort Typ)(pad(false false)))))(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0 1))(children(((Tile((id 95470)(label(Int))(mold((out Typ)(in_())(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0))(children()))))))))(Whitespace((id 113522)(content\" \")))(Tile((id 96204)(label(->))(mold((out Typ)(in_())(nibs(((shape(Concave((prec 6)(pad true))))(sort Typ))((shape(Concave((prec 6)(pad true))))(sort Typ))))))(shards(0))(children())))(Whitespace((id 113521)(content\" \")))(Tile((id 97129)(label(Bool))(mold((out Typ)(in_())(nibs(((shape Convex)(sort Typ))((shape Convex)(sort Typ))))))(shards(0))(children())))(Whitespace((id 113520)(content\" \"))))((Whitespace((id 97499)(content\"\226\143\142\")))(Tile((id 98243)(label(fun ->))(mold((out Exp)(in_(((sort Pat)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape(Concave((prec 14)(pad true))))(sort Exp))))))(shards(0 1))(children(((Whitespace((id 113519)(content\" \")))(Tile((id 98804)(label(xs))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Whitespace((id 113518)(content\" \"))))))))(Whitespace((id 99367)(content\"\226\143\142\")))(Tile((id 100307)(label(case end))(mold((out Exp)(in_(((sort Rul)(pad(true true)))))(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0 1))(children(((Whitespace((id 113517)(content\" \")))(Tile((id 100874)(label(xs))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 100875)(content\"\226\143\142\")))(Tile((id 101063)(label(| =>))(mold((out Rul)(in_(((sort Pat)(pad(true true)))))(nibs(((shape(Concave((prec 17)(pad true))))(sort Exp))((shape(Concave((prec 17)(pad true))))(sort Exp))))))(shards(0 1))(children(((Whitespace((id 113515)(content\" \")))(Tile((id 102011)(label(nil))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Whitespace((id 113514)(content\" \"))))))))(Whitespace((id 113516)(content\" \")))(Tile((id 103734)(label(false))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 103735)(content\"\226\143\142\")))(Tile((id 103926)(label(| =>))(mold((out Rul)(in_(((sort Pat)(pad(true true)))))(nibs(((shape(Concave((prec 17)(pad true))))(sort Exp))((shape(Concave((prec 17)(pad true))))(sort Exp))))))(shards(0 1))(children(((Whitespace((id 113512)(content\" \")))(Tile((id 104696)(label(hd))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Tile((id 105085)(label(::))(mold((out Pat)(in_())(nibs(((shape(Concave((prec 5)(pad false))))(sort Pat))((shape(Concave((prec 5)(pad false))))(sort Pat))))))(shards(0))(children())))(Tile((id 105665)(label(nil))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Whitespace((id 113511)(content\" \"))))))))(Whitespace((id 113513)(content\" \")))(Tile((id 107415)(label(false))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 107416)(content\"\226\143\142\")))(Tile((id 107610)(label(| =>))(mold((out Rul)(in_(((sort Pat)(pad(true true)))))(nibs(((shape(Concave((prec 17)(pad true))))(sort Exp))((shape(Concave((prec 17)(pad true))))(sort Exp))))))(shards(0 1))(children(((Whitespace((id 113509)(content\" \")))(Tile((id 108196)(label(a))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Tile((id 108591)(label(::))(mold((out Pat)(in_())(nibs(((shape(Concave((prec 5)(pad false))))(sort Pat))((shape(Concave((prec 5)(pad false))))(sort Pat))))))(shards(0))(children())))(Tile((id 108788)(label(b))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Tile((id 109183)(label(::))(mold((out Pat)(in_())(nibs(((shape(Concave((prec 5)(pad false))))(sort Pat))((shape(Concave((prec 5)(pad false))))(sort Pat))))))(shards(0))(children())))(Tile((id 109772)(label(nil))(mold((out Pat)(in_())(nibs(((shape Convex)(sort Pat))((shape Convex)(sort Pat))))))(shards(0))(children())))(Whitespace((id 113508)(content\" \"))))))))(Whitespace((id 113510)(content\" \")))(Tile((id 111351)(label(true))(mold((out Exp)(in_())(nibs(((shape Convex)(sort Exp))((shape Convex)(sort Exp))))))(shards(0))(children())))(Whitespace((id 111549)(content\"\226\143\142\"))))))))(Whitespace((id 112537)(content\"\226\143\142\"))))))))(Whitespace((id 113130)(content\"\226\143\142\")))(Whitespace((id 113328)(content\" \"))))((Grout((id 113525)(sort Exp)(shape Convex))))))(ancestors())))(caret Outer)))",
    backup_text: "let int_lits : Int = 1 in\nlet negation = -1 in\nlet arithmetic = 1*2 + 8/4 in\nlet int_comparison = (10 == 10, 1 < 2, 2 <= 3, 3 > 2, 2 >= 1) in\n\nlet float_lits : Float = 1.5 in\nlet float_artih = 1. *. 2. +. 8. /. 4. in\nlet float_comparison = (10. ==. 10., 1. <. 2., 2. <=. 3., 3. >. 2., 2. >=. 1.) in\n\nlet booleans : (Bool, Bool) = (true, false) in\nlet conditionals =\nlet (x, y) = (2 + 2, 3 + 3) in\nif y > x then 1 \nelse 2 \nin\n\nlet tuples : (Int, Bool, (Bool, Int)) = (1, true, (false, 3)) in\nlet (a, b, (c, d)) = tuples in\n\nlet y : (Int, Int, Int) -> Int =\nfun (m, x, b) -> m * x + b \nin\n\nlet double_recursively : Int -> Int =\nfun n ->\nif n == 0 then 0 \nelse double_recursively(n - 1) + 2 \nin\n\nlet empty_list : [Int] = nil in\nlet non_empty_list : [Int] = 1::2::3::nil in\nlet list_literals : [Int] = [1, 2, 3] in\nlet length : [Int] -> Int =\nfun xs ->\ncase xs\n| nil => 0\n| hd::tl => 1 + length(tl) \nend \nin\nlet has_at_least_two_elements : [Int] -> Bool =\nfun xs ->\ncase xs\n| nil => false\n| hd::nil => false\n| a::b::nil => true \nend \nin\n ",
  },
  empty,
  empty,
  empty,
  empty,
  empty,
  empty,
  empty,
];

let of_state = (state: ScratchSlide.state) => {
  {
    serialized_state: ScratchSlide.serialize(state),
    backup_text: ScratchSlide.serialize_backup(state),
  };
};

let to_state = export =>
  switch (ScratchSlide.deserialize_opt(export.serialized_state)) {
  | Some(state) => state
  | None =>
    print_endline(
      "Warning: using backup text! Serialization may be for an older version of Hazel.",
    );
    ScratchSlide.deserialize_backup(export.backup_text);
  };

let persist = (state: ScratchSlide.state) => {
  of_state(state) |> yojson_of_t;
};

let unpersist = data => {
  t_of_yojson(data);
};

let serialize = (state: ScratchSlide.state) => {
  persist(state) |> Yojson.Safe.to_string;
};

let deserialize = data => {
  data |> Yojson.Safe.from_string |> unpersist;
};

let init = (): Editors.scratch => {
  (0, List.map(to_state, defaults));
};

let init_nth = n => {
  to_state(List.nth(defaults, n));
};

let import = data => {
  data |> deserialize |> to_state;
};

let export = state => {
  state |> persist;
};
