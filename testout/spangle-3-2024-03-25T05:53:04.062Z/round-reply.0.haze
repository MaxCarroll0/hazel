fun (playlist, action) ->
  case action
  | PlaySong(id) => (fst playlist, Playing(id))
  | PauseCurrentSong => (fst playlist, case snd playlist of | Playing(id) => PausedOn(id) | _ => snd playlist end)
  | RemoveSong(id) => (List.filter (fun item -> item != id) fst playlist, snd playlist)
  | AddSong(id) => (id :: fst playlist, snd playlist)
  end