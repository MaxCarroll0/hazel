
fun model, action ->
case action
| AddTodo =>
  let (buffer, todos) = model in
  let todo = buffer, false in
  (string_concat(buffer, string_sub(buffer, 0, 0)), add(model))
| RemoveTodo(idx) => 
  let (buffer, todos) = model in
  (buffer, remove(idx,todos))
| ToggleTodo(idx) => 
  let (buffer, todos) = model in
  (buffer, toggle(idx, todos))
| UpdateBuffer(new_buffer) => 
  (string_trim(new_buffer), snd(model))
end