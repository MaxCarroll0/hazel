fun model, action ->
  case action
  | AddBooking(user, weekday, timeOfDay) => 
      let newBooking = ((weekday, timeOfDay), user, model.3 + 1) in 
      (model.1, newBooking :: model.2, model.3 + 1)
  | CancelBooking(user, bookingID) => 
      let updatedBookings = rm_booking(user, bookingID, model.2) in 
      (model.1, updatedBookings, if List.length(updatedBookings) == 0 then 1 else model.3)
  | ClearBookings => (model.1, [], model.3)
  end
in
