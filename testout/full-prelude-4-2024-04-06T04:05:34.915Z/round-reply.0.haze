fun (model, action) ->
  let formData, bookings, nextId = model in
  case action
    | AddBooking(user, weekday, tod) =>
      if bookingExists(model, ((weekday, tod), user, nextId))
      then model
      else ((weekday, tod), user, nextId + 1)::bookings, nextId + 1
    | CancelBooking(user, id) =>
      (formData, rm_booking(user, id, bookings), nextId)
    | ClearBookings => (formData, [], nextId)
  end