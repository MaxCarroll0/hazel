fun model, action ->
  let form, bookings, next_id = model in
  case action
    | AddBooking(user, day, tod) =>
      if bookingExists(model, ((day, tod), user, next_id)) then model
      else ((day, tod), user), bookings ++ [((day, tod), user, next_id)], next_id + 1
    | CancelBooking(user, id) => form, rm_booking(user, id, bookings), next_id
    | ClearBookings => form, [], next_id
  end