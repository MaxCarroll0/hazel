fun playlist, action ->
  case action
  | PlaySong(id) => (fst(playlist), Playing(id))
  | PauseCurrentSong => (fst(playlist), (case snd(playlist) of | Playing(id) => PausedOn(id) | _ => snd(playlist) end))
  | RemoveSong(id) => ((List.filter(fun song -> song != id, fst(playlist)), (case snd(playlist) of | Playing(current) when current == id => NoSongSelected | _ => snd(playlist) end))
  | AddSong(id) => (id::fst(playlist), snd(playlist))
  end