
fun model, action ->
    case action
    | AddTodo => (model.0, (model.0, false)::model.1)
    | RemoveTodo(idx) => (model.0, List.remove_at(idx, model.1))
    | ToggleTodo(idx) =>
      let new_todos = List.mapi((fun i, (name, done) -> if i == idx then (name, not done) else (name, done)), model.1) in
      (model.0, new_todos)
    | UpdateBuffer(new_buffer) => (new_buffer, model.1)
    end