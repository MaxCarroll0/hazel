fun (model, action) ->
  case action
    | Draw(x, y, c) => {model with canvas = set_pixel(model.canvas, x, y, c)}
    | Undo => model.history |> List.tl |> get_first
    | Redo => model.future |> List.hd
  end