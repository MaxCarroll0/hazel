fun (playlist, action) ->
  case playlist, action
  | (songlist, state), PlaySong(id) => (songlist, Playing(id))
  | (songlist, state), PauseCurrentSong => 
    case state 
    | Playing(id) => (songlist, PausedOn(id))
    | _ => playlist
    end
  | (songlist, state), RemoveSong(id) => (List.filter(fun song -> song != id, songlist), if songlist == [] then NoSongSelected else state end)
  | (songlist, state), AddSong(id) => (id::songlist, state)
  end
end