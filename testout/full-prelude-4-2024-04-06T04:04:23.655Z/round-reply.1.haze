fun model, action ->
  case action
  | AddBooking(user, day, tod) =>
      let (form, bookings, nextId) = model in
      if bookingExists(model, ((day, tod), user, nextId))
      then model
      else ((day, tod), user), ((day, tod), user, nextId+1)::bookings, nextId+1
  | CancelBooking(user, id) =>
      let (form, bookings, _) = model in
      form, rm_booking(user, id, bookings), _
  | ClearBookings =>
      let (form, _, _) = model in
      form, [], _
  end
in