fun (model, action) ->
  case action
  | Draw(x, y, color) =>
    { model with
      canvas = Canvas.setPixel(x, y, color, model.canvas);
    }
  | SetColor(color) =>
    { model with
      currentColor = color;
    }
  | Clear =>
    { model with
      canvas = Canvas.createEmpty();
    }
  end