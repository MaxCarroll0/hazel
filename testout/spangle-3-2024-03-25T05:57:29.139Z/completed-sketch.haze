# Update Playlist app model based on an action #

let update: (PlayList, PlayListAction) -> PlayList =
  fun model, action ->
case action
| Play -> { model with state = Playing }
| Pause -> { model with state = Paused }
| Stop -> { model with state = Stopped }
| Add id -> { model with songs = List.append(model.songs, [id]) }
| Delete id -> { model with songs = List.remove(id, model.songs) }
| Sort -> { model with songs = List.sort(fun a, b -> a.id - b.id, model.songs) }
end
in