fun model, action ->
  case action
  | AddBooking(user, weekday, timeofday) => ...
  | CancelBooking(user, id) => ...
  | ClearBookings => ...
  | ClearRange(start_time, end_time) => ...
  end