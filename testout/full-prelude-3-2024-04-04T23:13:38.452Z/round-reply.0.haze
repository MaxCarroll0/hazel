
fun model, action ->
  let (formData, bookings, nextID) = model in
  case action
  | AddBooking(user, day, time) => 
      if bookingExists(model, ((day, time), user, nextID)) 
      then model 
      else ((day, time), user, nextID+1)::bookings, nextID+1
  | CancelBooking(user, id) => formData, rm_booking(user, id, bookings), nextID
  | ClearBookings => formData, [], nextID
  end