fun model, action ->
  case model
    | (formState, bookings, nextId) =>
      case action
        | AddBooking(user, day, time) =>
          if bookingExists(model, ((day, time), user, nextId))
          then model
          else ((formState, ((day, time), user, nextId + 1)::bookings, nextId + 1))
        | CancelBooking(user, id) =>
          (formState, rm_booking(user, id, bookings), nextId)
        | ClearBookings =>
          (formState, [], nextId)
      end
  end