fun model, action ->
  case action
  | Reset => { model_init }
  | Select emoji => { model with selected = emoji }
  | Paint(row, col) => 
    let new_grid = updateGrid(model.grid, row, col, model.selected) 
    in { model with grid = new_grid }
  | FillRow row => 
    let new_grid = fillRowInGrid(model.grid, row, model.selected) 
    in { model with grid = new_grid }
  end