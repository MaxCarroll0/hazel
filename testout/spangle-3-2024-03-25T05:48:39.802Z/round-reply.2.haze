fun (model, action) ->
  case action
  | AddSong(song) =>
      if !List.mem(song, get_songs(model)) && true 
      then  model
      else  model with { songs = song :: model.songs }
  | DeleteSong(song) =>
     { model with songs = List.filter((fun s -> s != song), model.songs) }
  | SetState(state) => 
      { model with state = state }
  | SortSongList(cmp) =>
      { model with songs = List.sort(cmp, model.songs) }
  end