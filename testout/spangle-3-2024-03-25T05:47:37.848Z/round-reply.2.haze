fun (model, action) ->
  case action
    | Remove(id) => List.filter(fun item -> get_id(item) != id, model)
    | Add(item) => (item :: model)
    | Sort(cmp) => List.sort(cmp, model)
    | Reverse() => List.reverse(model)
  end