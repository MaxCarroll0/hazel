
fun model, action ->
  case model, action
    | (form, bookings, next_id), AddBooking(user, day, tod) =>
        if !bookingExists(model, ((day, tod), user, next_id))
        then model
        else ((day, tod), user), bookings ++ [((day, tod), user, next_id)], next_id + 1
    | (form, bookings, next_id), CancelBooking(user, id) =>
        form, rm_booking(user, id, bookings), next_id
    | (form, bookings, next_id), ClearBookings =>
        initFormState, [], next_id
  end