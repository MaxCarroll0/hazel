fun model, action ->
  case action
    | AddBooking(user, weekday, time) =>
      let new_booking = ((weekday, time), user, model.2 + 1) in
      if bookingExists(model, new_booking) 
      then model
      else ((weekday, time), user, model.2 + 1)::model.1, model.2 + 1
    | CancelBooking(user, id) =>
      let bookings = rm_booking(user, id, model.1) in
      (model.0, bookings, model.2)
    | ClearBookings =>
      (model.0, [], model.2)
  end